# Copyright Â© 2024 Quantum Interface (quantuminterface@ipe.kit.edu)
# Lukas Scheller, IPE, Karlsruhe Institute of Technology
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.
[build-system]
requires = ["hatchling>=1.25", "hatch-vcs>=0.4", "grpcio-tools==1.66.1"]
build-backend = "hatchling.build"

[project]
name = "ipe_servicehub_protos"
authors = [
    { name = "Quantum Interface", email = "quantuminterface@ipe.kit.edu" },
]
description = "Generated protobuf files."
readme = "README.md"
license = { file = "COPYING" }
dependencies = [
    # `grpcio`, `grpcio-tools` and `protobuf` should always get exact version
    # numbers to prevent mismatches between the generated protobuf version
    # and runtime protobuf version
    "grpcio==1.66.1",
    "protobuf==5.27.2",
]
requires-python = ">= 3.8"
classifiers = [
    "Development Status :: 3 - Alpha",
    "Operating System :: OS Independent",
    "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.8",
]
dynamic = ["version"]

[project.urls]
Repository = "https://github.com/quantuminterface/qiclib"

[tool.hatch.build.hooks.custom]
path = 'build_protos.py'

[tool.hatch.build.targets.wheel]
artifacts = [
  "src/ipe_servicehub_protos/*_pb2.py",
  "src/ipe_servicehub_protos/*_pb2_grpc.py",
  "src/ipe_servicehub_protos/*_pb2.pyi",
]

[tool.hatch.version]
source = "vcs"
raw-options = { root = ".." }

[tool.hatch.build.hooks.vcs]
version-file = "src/ipe_servicehub_protos/_version.py"

[tool.mypy]
# This can be generated when the name of a field is a reserved name in python.
# To workaround in code, the getattr() function can be used.
disable_error_code = ["valid-type"]

[[tool.mypy.overrides]]
module = ["grpc", "grpc.*"]
ignore_missing_imports = true
