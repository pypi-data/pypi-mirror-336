[project]
name = "motile-tracker"
channels = [
  "conda-forge",
  "funkelab",
  "gurobi"
]

platforms = ["win-64", "linux-64", "osx-arm64", "osx-64"]
preview = [ "pixi-build" ]

[dependencies]
python = "3.11.*"
pip = "*"
scip = "9.1.*"
pyinstaller = "*"

[pypi-dependencies]
ilpy = "==0.4.1"
motile_tracker = { path = ".", editable = true }

[tasks]
setup = { cmd = "pip install ." }
start = { cmd = "python -m motile_tracker.launcher" }
create-app = { cmd = "echo Create native app" }
create-installer = { cmd = "echo Package app installer" }

[feature.test.dependencies]
pytest = "*"

[feature.test.pypi-dependencies]
motile_tracker = { path = ".", editable = false }

[feature.test.tasks]
test = "pytest tests"

[target.osx-arm64.tasks.create-app]
cmd = "pyinstaller motile-tracker.spec"
outputs = [ "dist/MotileTracker/MotileTracker" ]

[target.win-64.tasks.create-app]
cmd = "pyinstaller motile-tracker.spec"
outputs = [ "dist/MotileTracker/MotileTracker.exe" ]

[target.linux-64.tasks.create-app]
cmd = "pyinstaller motile-tracker.spec"
outputs = [ "dist/MotileTracker/MotileTracker" ]

[target.osx-arm64.tasks.create-installer]
depends-on = [ "create-app" ]
cmd = "install-scripts/create-dmg.sh"
outputs = [ "dist/MotileTracker.dmg" ]

[target.win-64.tasks.create-installer]
depends-on = [ "create-app" ]
cmd = "iscc install-scripts/wininstaller.iss"
outputs = [ "dist/MotileTrackerInstaller.exe" ]

[target.linux-64.tasks.create-installer]
depends-on = [ "create-app" ]
cmd = "cp install-scripts/finalize-install.sh dist/MotileTracker && makeself --target /opt/MotileTracker --license LICENSE dist/MotileTracker dist/MotileTrackerInstaller.run \"MotileTracker Installer\" ./finalize-install.sh"
outputs = [ "dist/MotileTrackerInstaller.run" ]

[environments]
test = [ "test" ]

[package]
name = "motile-tracker"
version = "v3.1.3"

[package.build]
backend = { name = "pixi-build-python", version = "0.1.*" }
