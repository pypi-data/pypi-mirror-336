(()=>{"use strict";var e,o,t,n={341:(e,o,t)=>{const n=t(9560),r=t(1283),i=t(4448),s=t(3179);(0,i.run)((e=>new s.LibroAnalyzer(e)),(()=>{new n.BackgroundAnalysisRunner(new r.ServiceProvider).start()}))},3179:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.LibroAnalyzer=void 0;const n=t(4221),r=t(2451),i=t(8863),s=t(3306);class c extends i.PyrightServer{constructor(){super(...arguments),this.notebookDocuments=new Map}setupConnection(e,o){super.setupConnection(e,o),this.connection.notebooks.synchronization.onDidOpenNotebookDocument((async e=>this.onDidOpenNotebookDocument(e))),this.connection.notebooks.synchronization.onDidChangeNotebookDocument((async e=>this.onDidChangeNotebookDocument(e))),this.connection.notebooks.synchronization.onDidSaveNotebookDocument((async e=>this.onDidSaveNotebookDocument(e))),this.connection.notebooks.synchronization.onDidCloseNotebookDocument((async e=>this.onDidCloseNotebookDocument(e)))}initialize(e,o,t){const n=super.initialize(e,o,t);return n.capabilities.notebookDocumentSync={notebookSelector:[{notebook:{notebookType:"*"},cells:[{language:"python"}]}]},n}async onDidOpenNotebookDocument(e){const o=this.decodeUri(e.notebookDocument.uri);let t,r=this.notebookDocuments.get(o.key);r?this.console.error(`Received redundant open notebook document command for ${o}`):r=s.NotebookDocument.create(e.notebookDocument.uri,e.notebookDocument.notebookType,e.notebookDocument.version,e.notebookDocument.cells),this.notebookDocuments.set(o.key,r);for(const o of e.cellTextDocuments)await this.onDidOpenTextDocument({textDocument:o},n.IPythonMode.CellDocs,t),t=this.decodeUri(o.uri)}async onDidChangeNotebookDocument(e){this.recordUserInteractionTime();const o=this.decodeUri(e.notebookDocument.uri),t=this.notebookDocuments.get(o.key);if(void 0===t)return void this.console.error(`Received change notebook document command for closed file ${o}`);t.version=e.notebookDocument.version;const r=e.change;if(void 0!==r.metadata&&(t.metadata=r.metadata),void 0!==r.cells){const e=r.cells;if(void 0!==e.structure){const r=e.structure.array;if(t.cells.splice(r.start,r.deleteCount,...void 0!==r.cells?r.cells:[]),void 0!==e.structure.didOpen)for(const o of e.structure.didOpen){const e=t.cells.findIndex((e=>e.document===o.uri)),r=e>0?t.cells[e-1]:void 0,i=(null==r?void 0:r.document)?this.decodeUri(null==r?void 0:r.document):void 0;await this.onDidOpenTextDocument({textDocument:o},n.IPythonMode.CellDocs,i)}if(e.structure.didClose)for(const o of e.structure.didClose)await this.onDidCloseTextDocument({textDocument:o});await this.updateChainedFile(o)}if(void 0!==e.data){const o=new Map(e.data.map((e=>[e.document,e])));for(let e=0;e<=t.cells.length;e++){const n=o.get(t.cells[e].document);if(void 0!==n&&(o.delete(n.document),0===o.size))break}}if(void 0!==e.textContent)for(const o of e.textContent)await this.onDidChangeTextDocument({textDocument:o.document,contentChanges:o.changes},n.IPythonMode.CellDocs)}}onDidSaveNotebookDocument(e){}onDidCloseNotebookDocument(e){const o=this.decodeUri(e.notebookDocument.uri);if(void 0!==this.notebookDocuments.get(o.key)){for(const o of e.cellTextDocuments)this.onDidCloseTextDocument({textDocument:o});this.notebookDocuments.delete(o.key)}}async onDidOpenTextDocument(e,o,t){const n=this.decodeUri(e.textDocument.uri);let i=this.openFileMap.get(n.key);i?(this.console.error(`Received redundant open text document command for ${n}`),r.TextDocument.update(i,[{text:e.textDocument.text}],e.textDocument.version)):i=r.TextDocument.create(e.textDocument.uri,"python",e.textDocument.version,e.textDocument.text),this.openFileMap.set(n.key,i),(await this.getContainingWorkspacesForFile(n)).forEach((r=>{r.service.setFileOpened(n,e.textDocument.version,e.textDocument.text,o,t)}))}async updateChainedFile(e){const o=this.notebookDocuments.get(e.key);if(!o)return;if(this.hasSameCell(o))return;let t;for(const e of o.cells){const o=this.decodeUri(e.document);(await this.getContainingWorkspacesForFile(this.decodeUri(e.document))).forEach((e=>{e.service.updateChainedUri(o,t)})),t=o}}hasSameCell(e){return new Set(e.cells.map((e=>e.document))).size!==e.cells.length}onShutdown(e){return this.notebookDocuments.clear(),super.onShutdown(e)}}o.LibroAnalyzer=c},9491:e=>{e.exports=require("assert")},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},1808:e=>{e.exports=require("net")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},4521:e=>{e.exports=require("readline")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},4655:e=>{e.exports=require("v8")},1267:e=>{e.exports=require("worker_threads")},9796:e=>{e.exports=require("zlib")}},r={};function i(e){var o=r[e];if(void 0!==o)return o.exports;var t=r[e]={id:e,loaded:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.loaded=!0,t.exports}i.m=n,i.x=()=>{var e=i.O(void 0,[736,194],(()=>i(341)));return i.O(e)},e=[],i.O=(o,t,n,r)=>{if(!t){var s=1/0;for(a=0;a<e.length;a++){for(var[t,n,r]=e[a],c=!0,u=0;u<t.length;u++)(!1&r||s>=r)&&Object.keys(i.O).every((e=>i.O[e](t[u])))?t.splice(u--,1):(c=!1,r<s&&(s=r));if(c){e.splice(a--,1);var d=n();void 0!==d&&(o=d)}}return o}r=r||0;for(var a=e.length;a>0&&e[a-1][2]>r;a--)e[a]=e[a-1];e[a]=[t,n,r]},i.d=(e,o)=>{for(var t in o)i.o(o,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((o,t)=>(i.f[t](e,o),o)),[])),i.u=e=>({194:"pyright-internal",736:"vendor"}[e]+".js"),i.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),t={826:1},i.O.require=e=>t[e],i.f.require=(e,o)=>{t[e]||(e=>{var o=e.modules,n=e.ids,r=e.runtime;for(var s in o)i.o(o,s)&&(i.m[s]=o[s]);r&&r(i);for(var c=0;c<n.length;c++)t[n[c]]=1;i.O()})(require("./"+i.u(e)))},o=i.x,i.x=()=>(i.e(736),i.e(194),o()),i.x()})();
//# sourceMappingURL=index.js.map