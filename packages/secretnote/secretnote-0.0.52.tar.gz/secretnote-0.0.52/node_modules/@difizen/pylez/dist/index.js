(()=>{var e,t,o,n={6414:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotebookCellScheme=void 0,t.NotebookCellScheme="vscode-notebook-cell"},1440:(e,t,o)=>{"use strict";(0,o(2091).main)(1)},2091:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.main=function(e){(0,i.run)((t=>new s.Pylez(t,e)),(()=>{new n.BackgroundAnalysisRunner(new r.ServiceProvider).start()}))};const n=o(5080),r=o(6846),i=o(3009),s=o(8802)},8802:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pylez=void 0;const n=o(8210),r=o(9180),i=o(5025),s=o(6028),c=o(5080),a=o(8406),l=o(7824),u=o(2076),d=o(8909),h=o(5261),p=o(769),g=o(9901),m=o(3343),v=o(9029),y=o(2816),b=o(8643),f=o(6734),D=o(2772),k=o(38),C=o(9590),x=o(1748),S=o(6063),F=o(7569),P=o(9738),O=o(6414),T={openFilesTimeInMs:50,noOpenFilesTimeInMs:200};class w extends k.LanguageServerBase{constructor(e,t,r){const i=o(8330).rE||"",s=new v.RealTempFile,c=new d.ConsoleWithLogLevel(e.console),l=new v.WorkspaceFileWatcherProvider,u=null!=r?r:(0,v.createFromRealFileSystem)(s,c,l),h=new x.PyrightFileSystem(u),p=new n.CacheManager(t),m=(0,y.createServiceProvider)(h,s,c,p),D=(0,f.getRootUri)(m)||b.Uri.file(__dirname,m);super({productName:"Pylez",rootDirectory:h.realCasePath(D),version:i,serviceProvider:m,fileWatcherHandler:l,cancellationProvider:new g.FileBasedCancellationProvider("bg"),maxAnalysisTimeInForeground:T,supportedCodeActions:[F.CodeActionKind.QuickFix,F.CodeActionKind.SourceOrganizeImports]},e),this.notebookDocuments=new Map,this._controller=new a.CommandController(this)}async getSettings(e){const t={watchForSourceChanges:!0,watchForLibraryChanges:!0,watchForConfigChanges:!0,openFilesOnly:!0,useLibraryCodeForTypes:!0,disableLanguageServices:!1,disableTaggedHints:!1,disableOrganizeImports:!1,typeCheckingMode:"standard",diagnosticSeverityOverrides:{},logLevel:d.LogLevel.Info,autoImportCompletions:!0,functionSignatureDisplay:u.SignatureDisplayType.formatted};try{const o=this.workspaceFactory.getNonDefaultWorkspaces(S.WellKnownWorkspaceKinds.Regular),n=await this.getConfiguration(e.rootUri,"python");if(n){const r=n.pythonPath;r&&(0,h.isString)(r)&&!(0,i.isPythonBinary)(r)&&(t.pythonPath=(0,p.resolvePathWithEnvVariables)(e,r,o));const s=n.venvPath;s&&(0,h.isString)(s)&&(t.venvPath=(0,p.resolvePathWithEnvVariables)(e,s,o))}const r=await this.getConfiguration(e.rootUri,"python.analysis");if(r){const n=r.typeshedPaths;if(n&&Array.isArray(n)&&n.length>0){const r=n[0];r&&(0,h.isString)(r)&&(t.typeshedPath=(0,p.resolvePathWithEnvVariables)(e,r,o))}const i=r.stubPath;i&&(0,h.isString)(i)&&(t.stubPath=(0,p.resolvePathWithEnvVariables)(e,i,o));const s=r.diagnosticSeverityOverrides;if(s)for(const[e,o]of Object.entries(s)){const n=this.getDiagnosticRuleName(e),r=this.getSeverityOverrides(o);n&&r&&(t.diagnosticSeverityOverrides[n]=r)}void 0!==r.diagnosticMode?t.openFilesOnly=this.isOpenFilesOnly(r.diagnosticMode):void 0!==r.openFilesOnly&&(t.openFilesOnly=!!r.openFilesOnly),void 0!==r.useLibraryCodeForTypes&&(t.useLibraryCodeForTypes=!!r.useLibraryCodeForTypes),t.logLevel=(0,d.convertLogLevel)(r.logLevel),t.autoSearchPaths=!!r.autoSearchPaths;const c=r.extraPaths;c&&Array.isArray(c)&&c.length>0&&(t.extraPaths=c.filter((e=>e&&(0,h.isString)(e))).map((t=>(0,p.resolvePathWithEnvVariables)(e,t,o))).filter(h.isDefined)),t.includeFileSpecs=this._getStringValues(r.include),t.excludeFileSpecs=this._getStringValues(r.exclude),t.ignoreFileSpecs=this._getStringValues(r.ignore),void 0!==r.typeCheckingMode&&(t.typeCheckingMode=r.typeCheckingMode),void 0!==r.autoImportCompletions&&(t.autoImportCompletions=r.autoImportCompletions),t.logLevel===d.LogLevel.Log&&void 0!==r.logTypeEvaluationTime&&(t.logTypeEvaluationTime=r.logTypeEvaluationTime),void 0!==r.typeEvaluationTimeThreshold&&(t.typeEvaluationTimeThreshold=r.typeEvaluationTimeThreshold)}else t.autoSearchPaths=!0;const s=await this.getConfiguration(e.rootUri,"pylez");if(s){void 0!==s.openFilesOnly&&(t.openFilesOnly=!!s.openFilesOnly),void 0!==s.useLibraryCodeForTypes&&(t.useLibraryCodeForTypes=!!s.useLibraryCodeForTypes),t.disableLanguageServices=!!s.disableLanguageServices,t.disableTaggedHints=!!s.disableTaggedHints,t.disableOrganizeImports=!!s.disableOrganizeImports;const e=s.typeCheckingMode;e&&(0,h.isString)(e)&&(t.typeCheckingMode=e)}}catch(e){this.console.error(`Error reading settings: ${e}`)}return t}createBackgroundAnalysis(e){if(!(0,h.isDebugMode)()&&(0,l.getCancellationFolderName)())return new c.BackgroundAnalysis(this.serverOptions.serviceProvider)}getContainingWorkspacesForFile(e){return e.scheme===O.NotebookCellScheme&&(e=b.Uri.file(e.getPath(),this.serverOptions.serviceProvider)),this.workspaceFactory.getContainingWorkspacesForFile(e)}getWorkspaceForFile(e,t){return e.scheme===O.NotebookCellScheme&&(e=b.Uri.file(e.getPath(),this.serverOptions.serviceProvider)),this.workspaceFactory.getWorkspaceForFile(e,t)}createHost(){return new m.FullAccessHost(this.serverOptions.serviceProvider)}createImportResolver(e,t,o){const n=new r.ImportResolver(e,t,o);return n.invalidateCache(),n}executeCommand(e,t){return this._controller.execute(e,t)}isLongRunningCommand(e){return this._controller.isLongRunningCommand(e)}isRefactoringCommand(e){return this._controller.isRefactoringCommand(e)}async executeCodeAction(e,t){this.recordUserInteractionTime();const o=b.Uri.parse(e.textDocument.uri,this.serverOptions.serviceProvider),n=await this.getWorkspaceForFile(o);return C.CodeActionProvider.getCodeActionsForPosition(n,o,e.range,e.context.only,t)}createProgressReporter(){let e;return{isEnabled:e=>!0,begin:()=>{this.client.hasWindowProgressCapability?(e=this.connection.window.createWorkDoneProgress(),e.then((e=>{e.begin("")})).ignoreErrors()):this.connection.sendNotification("pyright/beginProgress")},report:t=>{e?e.then((e=>{e.report(t)})).ignoreErrors():this.connection.sendNotification("pyright/reportProgress",t)},end:()=>{e?(e.then((e=>{e.done()})).ignoreErrors(),e=void 0):this.connection.sendNotification("pyright/endProgress")}}}setupConnection(e,t){super.setupConnection(e,t),this.connection.notebooks.synchronization.onDidOpenNotebookDocument((async e=>this.onDidOpenNotebookDocument(e))),this.connection.notebooks.synchronization.onDidChangeNotebookDocument((async e=>this.onDidChangeNotebookDocument(e))),this.connection.notebooks.synchronization.onDidSaveNotebookDocument((async e=>this.onDidSaveNotebookDocument(e))),this.connection.notebooks.synchronization.onDidCloseNotebookDocument((async e=>this.onDidCloseNotebookDocument(e)))}async initialize(e,t,o){const n=await super.initialize(e,t,o);return n.capabilities.notebookDocumentSync={notebookSelector:[{notebook:{notebookType:"*"},cells:[{language:"python"}]}]},n}async onDidOpenNotebookDocument(e){const t=this.convertLspUriStringToUri(e.notebookDocument.uri);let o,n=this.notebookDocuments.get(t.key);n?this.console.error(`Received redundant open notebook document command for ${t}`):n=P.NotebookDocument.create(e.notebookDocument.uri,e.notebookDocument.notebookType,e.notebookDocument.version,e.notebookDocument.cells),this.notebookDocuments.set(t.key,n);for(const t of e.cellTextDocuments)await this.onDidOpenTextDocument({textDocument:t},s.IPythonMode.CellDocs,o),o=this.convertLspUriStringToUri(t.uri)}async onDidChangeNotebookDocument(e){this.recordUserInteractionTime();const t=this.convertLspUriStringToUri(e.notebookDocument.uri),o=this.notebookDocuments.get(t.key);if(void 0===o)return void this.console.error(`Received change notebook document command for closed file ${t}`);o.version=e.notebookDocument.version;const n=e.change;if(void 0!==n.metadata&&(o.metadata=n.metadata),void 0!==n.cells){const e=n.cells;if(void 0!==e.structure){const n=e.structure.array;if(o.cells.splice(n.start,n.deleteCount,...void 0!==n.cells?n.cells:[]),void 0!==e.structure.didOpen)for(const t of e.structure.didOpen){const e=o.cells.findIndex((e=>e.document===t.uri)),n=e>0?o.cells[e-1]:void 0,r=(null==n?void 0:n.document)?this.convertLspUriStringToUri(null==n?void 0:n.document):void 0;await this.onDidOpenTextDocument({textDocument:t},s.IPythonMode.CellDocs,r)}if(e.structure.didClose)for(const t of e.structure.didClose)await this.onDidCloseTextDocument({textDocument:t});await this.updateChainedFile(t)}if(void 0!==e.data){const t=new Map(e.data.map((e=>[e.document,e])));for(let e=0;e<=o.cells.length;e++){const n=t.get(o.cells[e].document);if(void 0!==n&&(t.delete(n.document),0===t.size))break}}if(void 0!==e.textContent)for(const t of e.textContent)await this.onDidChangeTextDocument({textDocument:t.document,contentChanges:t.changes},s.IPythonMode.CellDocs)}}onDidSaveNotebookDocument(e){}onDidCloseNotebookDocument(e){const t=this.convertLspUriStringToUri(e.notebookDocument.uri);if(void 0!==this.notebookDocuments.get(t.key)){for(const t of e.cellTextDocuments)this.onDidCloseTextDocument({textDocument:t});this.notebookDocuments.delete(t.key)}}async onDidOpenTextDocument(e,t,o){const n=this.convertLspUriStringToUri(e.textDocument.uri);let r=this.openFileMap.get(n.key);r?(this.console.error(`Received redundant open text document command for ${n}`),D.TextDocument.update(r,[{text:e.textDocument.text}],e.textDocument.version)):r=D.TextDocument.create(e.textDocument.uri,"python",e.textDocument.version,e.textDocument.text),this.openFileMap.set(n.key,r),(await this.getContainingWorkspacesForFile(n)).forEach((r=>{r.service.setFileOpened(n,e.textDocument.version,e.textDocument.text,t,o)}))}async updateChainedFile(e){const t=this.notebookDocuments.get(e.key);if(!t)return;if(this.hasSameCell(t))return;let o;for(const e of t.cells){const t=this.convertLspUriStringToUri(e.document);(await this.getContainingWorkspacesForFile(t)).forEach((e=>{e.service.updateChainedUri(t,o)})),o=t}}hasSameCell(e){return new Set(e.cells.map((e=>e.document))).size!==e.cells.length}onShutdown(e){return this.notebookDocuments.clear(),super.onShutdown(e)}_getStringValues(e){return e&&Array.isArray(e)&&0!==e.length?e.filter((e=>e&&(0,h.isString)(e))):[]}}t.Pylez=w},5100:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=5100,e.exports=t},5317:e=>{"use strict";e.exports=require("child_process")},6982:e=>{"use strict";e.exports=require("crypto")},4434:e=>{"use strict";e.exports=require("events")},9896:e=>{"use strict";e.exports=require("fs")},9278:e=>{"use strict";e.exports=require("net")},7975:e=>{"use strict";e.exports=require("node:util")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},3785:e=>{"use strict";e.exports=require("readline")},2203:e=>{"use strict";e.exports=require("stream")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},1493:e=>{"use strict";e.exports=require("v8")},8167:e=>{"use strict";e.exports=require("worker_threads")},3106:e=>{"use strict";e.exports=require("zlib")},8330:e=>{"use strict";e.exports={rE:"0.1.2"}}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={id:e,loaded:!1,exports:{}};return n[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.m=n,i.x=()=>{var e=i.O(void 0,[121,394],(()=>i(1440)));return i.O(e)},e=[],i.O=(t,o,n,r)=>{if(!o){var s=1/0;for(u=0;u<e.length;u++){for(var[o,n,r]=e[u],c=!0,a=0;a<o.length;a++)(!1&r||s>=r)&&Object.keys(i.O).every((e=>i.O[e](o[a])))?o.splice(a--,1):(c=!1,r<s&&(s=r));if(c){e.splice(u--,1);var l=n();void 0!==l&&(t=l)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[o,n,r]},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,o)=>(i.f[o](e,t),t)),[])),i.u=e=>({121:"vendor",394:"pyright-internal"}[e]+".js"),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o={57:1},i.O.require=e=>o[e],i.f.require=(e,t)=>{o[e]||(e=>{var t=e.modules,n=e.ids,r=e.runtime;for(var s in t)i.o(t,s)&&(i.m[s]=t[s]);r&&r(i);for(var c=0;c<n.length;c++)o[n[c]]=1;i.O()})(require("./"+i.u(e)))},t=i.x,i.x=()=>(i.e(121),i.e(394),t()),i.x()})();
//# sourceMappingURL=index.js.map