(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3853],{5226:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>B});var l=a(3576),r=a(62701),t=a(37876),i=a(30879),n=a(8320),c=a(30397),d=a(27955),o=a(23331),u=a(24094),h=a(7305),x=a(14107),m=a(22196),j=a(21505),f=a(21379),g=a(89099),b=a(14232),p=a(59578),v=a(92046),N=a(23693),y=a(93010),w=a(33810),E=a(33949),_=a(97623),S=a(37090),k=a(64553),P=a(12503),T=a(1958),A=a(99716),V=a(11699),O=a(86348),C=a(82955),D=a(99331),F=a(18709),I=a(73835),R=a(98594),z=a(7700);function L(e){let{title:s,description:a,type:i,numSamples:n,paperLink:c,onRun:d}=e,[o,u]=(0,b.useState)(!1),[h,x]=(0,b.useState)([]),[f,g]=(0,b.useState)(null),[p,v]=(0,b.useState)([]),[N,y]=(0,b.useState)(null),[L,W]=(0,b.useState)(1),[B,M]=(0,b.useState)({message:"",color:"default",isVisible:!1}),X=(e,s)=>{M({message:e,color:s,isVisible:!0}),setTimeout(()=>M(e=>(0,r._)((0,l._)({},e),{isVisible:!1})),3e3)};(0,b.useEffect)(()=>{o&&(async()=>{try{let e=await (0,z.bg)();x(e)}catch(e){console.error("Error fetching workflows:",e),X("Failed to load workflows.","danger")}})()},[o]),(0,b.useEffect)(()=>{f&&(async()=>{try{let e=await (0,z.sX)(f.id);v(e)}catch(e){console.error("Error fetching output variables:",e),X("Failed to load output variables.","danger")}})()},[f]);let G=async()=>{if(!f){X("Please select a workflow.","danger");return}if(!N){X("Please select an output variable.","danger");return}try{let e=await (0,z.CB)(f.id,s,N,L);X("Eval run started with ID: ".concat(e.run_id),"success"),u(!1)}catch(e){console.error("Error starting eval run:",e),X("Failed to start eval run.","danger")}};return(0,t.jsxs)(t.Fragment,{children:[B.isVisible&&(0,t.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,t.jsx)(j.B,{color:B.color,children:B.message})}),(0,t.jsxs)(w.Z,{className:"relative w-full",children:[(0,t.jsxs)(E.U,{className:"relative min-h-[220px] bg-gradient-to-br from-content1 to-default-100/50 p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:s}),(0,t.jsx)("p",{className:"text-default-500 text-sm mb-3",children:a}),(0,t.jsxs)("p",{className:"text-default-500 text-sm mb-1",children:[(0,t.jsx)("strong",{children:"Type:"})," ",i]}),(0,t.jsxs)("p",{className:"text-default-500 text-sm mb-1",children:[(0,t.jsx)("strong",{children:"Num Samples:"})," ",n]}),c&&(0,t.jsx)("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 text-sm",children:"Original Paper"})]}),(0,t.jsx)(_.d,{className:"border-t-1 border-default-100 justify-end py-2 px-4",children:(0,t.jsx)(m.T,{color:"primary",variant:"flat",onPress:()=>u(!0),startContent:(0,t.jsx)(R.In,{icon:"solar:play-linear",width:16}),children:"Run Eval"})})]}),(0,t.jsx)(S.Y,{isOpen:o,onOpenChange:u,children:(0,t.jsx)(k.g,{children:e=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.c,{className:"flex flex-col gap-1",children:"Eval Configuration"}),(0,t.jsxs)(T.h,{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold mb-2",children:"Select a Workflow"}),(0,t.jsxs)(A.A,{children:[(0,t.jsx)(V.b,{children:(0,t.jsx)(m.T,{variant:"flat",color:"primary",children:f?f.name:"Select a Workflow"})}),(0,t.jsx)(O.y,{"aria-label":"Workflows",onAction:e=>{let s=h.find(s=>s.id===e.toString());s&&(g(s),y(null))},children:h.map(e=>(0,t.jsx)(C.Y,{children:e.name},e.id))})]}),f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold mt-4 mb-2",children:"Select an Output Variable"}),(0,t.jsxs)(A.A,{children:[(0,t.jsx)(V.b,{children:(0,t.jsx)(m.T,{variant:"flat",color:"primary",children:N||"Select an Output Variable"})}),(0,t.jsx)(O.y,{"aria-label":"Output Variables",onAction:e=>y(e.toString()),children:Object.entries(p.reduce((e,s)=>{let{node_id:a,variable_name:l,prefixed_variable:r}=s;return e[a]||(e[a]=[]),e[a].push({variable_name:l,prefixed_variable:r}),e},{})).map(e=>{let[s,a]=e;return(0,t.jsx)(D.g,{title:"Node: ".concat(s),children:a.map(e=>{let{variable_name:s,prefixed_variable:a}=e;return(0,t.jsx)(C.Y,{children:s},a)})},s)})})]})]}),(0,t.jsx)("h3",{className:"text-sm font-semibold mt-4 mb-2",children:"Select Number of Samples"}),(0,t.jsx)(F.Q,{label:"Number of Samples",step:1,maxValue:n,minValue:1,defaultValue:1,value:L,onChange:e=>W(Number(e)),className:"max-w-md"})]}),(0,t.jsxs)(I.q,{children:[(0,t.jsx)(m.T,{color:"danger",variant:"light",onPress:e,children:"Cancel"}),(0,t.jsx)(m.T,{color:"primary",onPress:G,children:"Run Eval"})]})]})})})]})}let W={PENDING:"primary",RUNNING:"warning",COMPLETED:"success",FAILED:"danger"},B=()=>{let[e,s]=(0,b.useState)([]),[a,w]=(0,b.useState)([]),[E,_]=(0,b.useState)(!0),{theme:S}=(0,f.D)(),[k,P]=(0,b.useState)({message:"",color:"default",isVisible:!1}),T=(0,g.useRouter)(),A=(e,s)=>{P({message:e,color:s,isVisible:!0}),setTimeout(()=>P(e=>(0,r._)((0,l._)({},e),{isVisible:!1})),3e3)};(0,b.useEffect)(()=>{(async()=>{try{let e=await (0,z.c6)();s(e)}catch(e){console.error("Error fetching evals:",e),A("Failed to load evals.","danger")}finally{_(!1)}})()},[]),(0,b.useEffect)(()=>{let e=async()=>{try{let e=await (0,z.jb)(),s=await Promise.all(e.map(async e=>{if("COMPLETED"===e.status)try{let s=await (0,z.eW)(e.run_id);return(0,r._)((0,l._)({},e),{results:s.results})}catch(s){console.error("Error fetching results for run ".concat(e.run_id,":"),s)}return e}));w(s)}catch(e){console.error("Error fetching eval runs:",e),A("Failed to load eval runs.","danger")}};e();let s=setInterval(e,5e3);return()=>clearInterval(s)},[]);let V=async(e,s,a,l)=>{if(!e){A("Workflow ID is missing.","danger");return}if(!l){A("Output variable is missing.","danger");return}try{A("Launching eval with output variable: ".concat(l," and ").concat(a," samples..."),"default");let r=await (0,z.CB)(e,s,l,a);A("Eval run started.","success"),w(e=>[...e,r])}catch(e){console.error("Error launching eval:",e),A("Failed to launch eval.","danger")}},O=async e=>{T.push("/evals/".concat(e))};return(0,t.jsxs)("div",{className:"App relative",children:[(0,t.jsx)(y.A,{activePage:"evals"}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mt-8 mb-4",children:"Eval Jobs"}),a.length>0?(0,t.jsxs)(i.j,{"aria-label":"Eval Jobs Table",isHeaderSticky:!0,children:[(0,t.jsxs)(n.X,{children:[(0,t.jsx)(c.e,{children:"Run ID"}),(0,t.jsx)(c.e,{children:"Eval Name"}),(0,t.jsx)(c.e,{children:"Workflow ID"}),(0,t.jsx)(c.e,{children:"Status"}),(0,t.jsx)(c.e,{children:"Accuracy"}),(0,t.jsx)(c.e,{children:"Actions"})]}),(0,t.jsx)(d.E,{items:a,children:e=>(0,t.jsxs)(o.s,{children:[(0,t.jsx)(u.w,{children:e.run_id}),(0,t.jsx)(u.w,{children:e.eval_name}),(0,t.jsx)(u.w,{children:e.workflow_id}),(0,t.jsx)(u.w,{children:(0,t.jsx)(h.R,{className:"capitalize",color:W[e.status],size:"sm",variant:"flat",children:"RUNNING"===e.status?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(x.o,{size:"sm"}),e.status]}):e.status})}),(0,t.jsx)(u.w,{children:e.results&&void 0!==e.results.accuracy?(0,t.jsx)("div",{style:{width:50,height:50},children:(0,t.jsxs)(p.D,{width:50,height:50,cx:25,cy:25,innerRadius:18,outerRadius:25,barSize:7,data:[{name:"Accuracy",value:100*e.results.accuracy}],startAngle:90,endAngle:-270,children:[(0,t.jsx)(v.Z,{dataKey:"value",cornerRadius:12,fill:"dark"===S?"hsl(143 55% 62%)":"hsl(143 55% 42%)",background:{fill:"dark"===S?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)"}}),(0,t.jsx)(N.r,{type:"number",domain:[0,100],tick:!1}),(0,t.jsx)("text",{x:25,y:25,textAnchor:"middle",dominantBaseline:"middle",style:{fontSize:"11px",fontWeight:"600",fill:"dark"===S?"rgba(255, 255, 255, 0.95)":"rgba(0, 0, 0, 0.9)"},children:"".concat((100*e.results.accuracy).toFixed(1),"%")})]})}):"COMPLETED"===e.status?"N/A":"--"}),(0,t.jsx)(u.w,{children:"COMPLETED"===e.status?(0,t.jsx)(m.T,{size:"sm",onPress:()=>O(e.run_id),children:"View Examples"}):(0,t.jsx)("p",{children:"--"})})]},e.run_id)})]}):(0,t.jsx)("p",{children:"No eval runs available."}),(0,t.jsx)("div",{className:"my-8"}),(0,t.jsx)("h1",{className:"text-2xl font-bold mt-8 mb-4",children:"Available Evals"}),E?(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)(x.o,{size:"lg"})}):e.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,t.jsx)(L,{title:e.name,description:e.description,type:e.type,numSamples:e.num_samples,paperLink:e.paper_link,onRun:(s,a,l)=>V(s,e.name,a,l)},e.name))}):(0,t.jsx)("p",{children:"No evals available."})]}),k.isVisible&&(0,t.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,t.jsx)(j.B,{color:k.color,children:k.message})})]})}},54920:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/evals",function(){return a(5226)}])}},e=>{var s=s=>e(e.s=s);e.O(0,[5352,6361,2377,5892,9235,9177,6139,1494,3010,636,6593,8792],()=>s(54920)),_N_E=e.O()}]);