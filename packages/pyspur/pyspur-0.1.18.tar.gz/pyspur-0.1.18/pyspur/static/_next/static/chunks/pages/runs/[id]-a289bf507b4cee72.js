(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5876],{22004:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/runs/[id]",function(){return l(80482)}])},80482:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>M});var s=l(37876),a=l(14107),n=l(77328),r=l.n(n),i=l(89099),c=l(14232),u=l(31777),d=l(15749),x=l(30879),o=l(8320),m=l(30397),h=l(27955),f=l(23331),j=l(24094),N=l(7305),p=l(68586),v=l(41260),g=l(33566),w=l(9941),y=l(22196),E=l(98594),b=l(20622),C=l(92463),D=l(38892),_=l(7700),S=l(69501);let k=e=>{switch(e){case"COMPLETED":return"success";case"RUNNING":case"PENDING":case"PAUSED":return"warning";case"FAILED":case"CANCELLED":return"danger";default:return"default"}},I=e=>{switch(e){case"COMPLETED":return"solar:check-circle-linear";case"RUNNING":return"solar:running-linear";case"PENDING":return"solar:clock-circle-linear";case"PAUSED":return"solar:pause-circle-linear";case"FAILED":return"solar:danger-circle-linear";case"CANCELLED":return"solar:close-circle-linear";default:return"solar:question-circle-linear"}},T=c.memo(e=>{let{runs:t,isLoading:l,handleRunClick:n}=e,r=(e,t)=>{if(!e)return"-";let l=e.endsWith("Z")?e:e+"Z",s=(0,b.H)(l),a=t?t.endsWith("Z")?t:t+"Z":void 0,n=((a?(0,b.H)(a):new Date).getTime()-s.getTime())/1e3;if(n<60)return"".concat(Math.round(n),"s");if(n<3600)return"".concat(Math.floor(n/60),"m ").concat(Math.round(n%60),"s");{let e=Math.floor(n/3600),t=Math.floor(n%3600/60);return"".concat(e,"h ").concat(t,"m")}},i=e=>{let t=e.endsWith("Z")?e:e+"Z",l=(0,b.H)(t);return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{children:(0,C.GP)(l,"MMM d, yyyy HH:mm:ss 'UTC'")}),(0,s.jsx)("span",{className:"text-xs text-default-400",children:(0,D.m)(l,{addSuffix:!0})})]})};return l?(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsx)(a.o,{size:"lg"})}):0===t.length?(0,s.jsx)("div",{className:"flex justify-center p-8 text-default-500",children:"No runs found for this spur"}):(0,s.jsxs)(x.j,{"aria-label":"Spur Runs",isHeaderSticky:!0,children:[(0,s.jsx)(o.X,{columns:[{key:"run_id",label:"Run ID"},{key:"time",label:"Time (UTC)"},{key:"inputs",label:"Inputs"},{key:"duration",label:"Duration"},{key:"status",label:"Status"}],children:e=>(0,s.jsx)(m.e,{children:e.label},e.key)}),(0,s.jsx)(h.E,{items:t,children:e=>(0,s.jsx)(f.s,{children:t=>(0,s.jsx)(j.w,{children:"time"===t?e.start_time?i(e.start_time):"-":"inputs"===t?(0,s.jsx)("div",{children:e.initial_inputs?(0,s.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,s.jsx)(S.A,{output:Object.values(e.initial_inputs)[0]||{},maxHeight:"100px"})}):(0,s.jsx)("span",{className:"text-default-400",children:"No inputs"})}):"run_id"===t?(0,s.jsx)(N.R,{size:"sm",variant:"flat",className:"cursor-pointer",onClick:()=>n(e.id),children:e.id}):"duration"===t?(0,s.jsx)("span",{children:r(e.start_time,e.end_time)}):"status"===t?(0,s.jsx)(N.R,{size:"sm",variant:"flat",color:k(e.status),startContent:(0,s.jsx)(E.In,{icon:I(e.status),width:16}),children:e.status}):null})},e.id)})]})});T.displayName="RunsTable";let P=e=>{let{workflowId:t}=e;(0,i.useRouter)();let[l,a]=(0,c.useState)([]),[n,r]=(0,c.useState)(!0),[u,d]=(0,c.useState)(null),[x,o]=(0,c.useState)(null),[m,h]=(0,c.useState)("00:00"),[f,j]=(0,c.useState)("23:59"),[N,b]=(0,c.useState)("100"),[C,D]=(0,c.useState)(1),[S,k]=(0,c.useState)(!0),[I,P]=(0,c.useState)(!1),[L,R]=(0,c.useState)(""),A=(e,t)=>{let[l,s]=t.split(":").map(Number);return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),l,s))},M=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let l,s;let n=e?C+1:1;r(!e),e&&P(!0),u&&(l=A(new Date(u.toString()),m)),x&&(s=A(new Date(x.toString()),f));let i=await (0,_.ML)(t,n,parseInt(N),l,s,L||void 0),c=i.sort((e,t)=>{let l=e.start_time?new Date(e.start_time.endsWith("Z")?e.start_time:e.start_time+"Z").getTime():0;return(t.start_time?new Date(t.start_time.endsWith("Z")?t.start_time:t.start_time+"Z").getTime():0)-l});e?a(e=>[...e,...c]):a(c),D(n),k(i.length===parseInt(N))}catch(e){console.error("Error fetching workflow runs:",e)}finally{r(!1),P(!1)}};return(0,c.useEffect)(()=>{M();let e=setInterval(()=>{l.some(e=>"RUNNING"===e.status||"PENDING"===e.status||"PAUSED"===e.status)&&M()},5e3);return()=>clearInterval(e)},[t,u,x,m,f,N,L]),(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("label",{className:"text-sm text-default-600",children:"Start Date (UTC)"}),(0,s.jsx)(p.g,{value:u,onChange:d,labelPlacement:"outside",classNames:{base:"min-w-[200px]",input:"min-w-[200px]"}})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("label",{className:"text-sm text-default-600",children:"Start Time (UTC)"}),(0,s.jsx)(v.r,{type:"time",value:m,onChange:e=>h(e.target.value),className:"min-w-[150px]"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("label",{className:"text-sm text-default-600",children:"End Date (UTC)"}),(0,s.jsx)(p.g,{value:x,onChange:o,labelPlacement:"outside",classNames:{base:"min-w-[200px]",input:"min-w-[200px]"}})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("label",{className:"text-sm text-default-600",children:"End Time (UTC)"}),(0,s.jsx)(v.r,{type:"time",value:f,onChange:e=>j(e.target.value),className:"min-w-[150px]"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("label",{className:"text-sm text-default-600",children:"Number of Runs"}),(0,s.jsxs)(g.d,{value:N,onChange:e=>b(e.target.value),className:"min-w-[120px]",children:[(0,s.jsx)(w.y,{value:"10",children:"10 runs"},"10"),(0,s.jsx)(w.y,{value:"20",children:"20 runs"},"20"),(0,s.jsx)(w.y,{value:"100",children:"100 runs"},"100"),(0,s.jsx)(w.y,{value:"200",children:"200 runs"},"200")]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("label",{className:"text-sm text-default-600",children:"Status"}),(0,s.jsx)(g.d,{value:L,onChange:e=>R(e.target.value),className:"min-w-[150px]",children:[{label:"All",value:""},{label:"Completed",value:"COMPLETED"},{label:"Running",value:"RUNNING"},{label:"Pending",value:"PENDING"},{label:"Failed",value:"FAILED"},{label:"Cancelled",value:"CANCELLED"},{label:"Paused",value:"PAUSED"}].map(e=>(0,s.jsx)(w.y,{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(y.T,{color:"primary",onClick:()=>{D(1),M()},children:"Apply Filter"}),(0,s.jsx)(y.T,{variant:"flat",onClick:()=>{d(null),o(null),h("00:00"),j("23:59"),b("100"),R(""),D(1)},children:"Clear"})]})]}),(0,s.jsx)(T,{runs:l,isLoading:n,handleRunClick:e=>{window.open("/trace/".concat(e),"_blank")}}),S&&(0,s.jsx)("div",{className:"flex justify-center mt-4",children:(0,s.jsx)(y.T,{variant:"flat",onPress:()=>{M(!0)},isLoading:I,startContent:!I&&(0,s.jsx)(E.In,{icon:"lucide:plus",width:16}),children:I?"Loading...":"Load More"})})]})};var L=l(3895),R=l(93010),A=l(34233);let M=()=>{let{id:e}=(0,i.useRouter)().query,[t,l]=(0,c.useState)(""),[n,x]=(0,c.useState)(!0),o=(0,u.wA)();return((0,c.useEffect)(()=>{let t=async()=>{if("string"==typeof e)try{let t=await (0,_.Mw)(e);l(t.name),o((0,L.XK)(t.name))}catch(e){console.error("Error fetching workflow:",e)}finally{x(!1)}};e&&t()},[e]),e&&"string"==typeof e)?n?(0,s.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,s.jsx)(a.o,{size:"lg"})}):(0,s.jsxs)(d.Q,{loading:null,persistor:A.q,children:[(0,s.jsx)(r(),{children:(0,s.jsx)("title",{children:t?"".concat(t," - Runs"):"Spur Runs"})}),(0,s.jsxs)("div",{style:{height:"100vh",display:"flex",flexDirection:"column"},children:[(0,s.jsx)(R.A,{activePage:"runs",associatedWorkflowId:e}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-6 flex-grow",children:(0,s.jsx)(P,{workflowId:e})})]})]}):(0,s.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,s.jsx)("div",{className:"text-default-500",children:"Invalid workflow ID"})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5352,6361,2377,5892,9235,9177,9217,9615,6190,8892,9129,3010,9501,636,6593,8792],()=>t(22004)),_N_E=e.O()}]);