/*! For license information please see vault.51831610fdbf87be94b5.js.LICENSE.txt */
try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="182f8d2a-d584-44cf-9c72-379cbfe2dabd",e._sentryDebugIdIdentifier="sentry-dbid-182f8d2a-d584-44cf-9c72-379cbfe2dabd")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"0.11.0"}}!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.swh=t():(e.swh=e.swh||{},e.swh.vault=t())}(self,(function(){return function(){var __webpack_modules__={4633:function(e,t,n){var r=n(73738).default;function o(){"use strict";e.exports=o=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var t,n={},a=Object.prototype,i=a.hasOwnProperty,c=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",d=s.toStringTag||"@@toStringTag";function p(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(t){p=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof k?t:k,a=Object.create(o.prototype),i=new I(r||[]);return c(a,"_invoke",{value:E(e,n,i)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=f;var _="suspendedStart",v="suspendedYield",b="executing",g="completed",w={};function k(){}function y(){}function m(){}var x={};p(x,u,(function(){return this}));var T=Object.getPrototypeOf,j=T&&T(T(F([])));j&&j!==a&&i.call(j,u)&&(x=j);var $=m.prototype=k.prototype=Object.create(x);function S(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,a,c,s){var u=h(e[o],e,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,c,s)}),(function(e){n("throw",e,c,s)})):t.resolve(d).then((function(e){l.value=e,c(l)}),(function(e){return n("throw",e,c,s)}))}s(u.arg)}var o;c(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(a,a):a()}})}function E(e,n,r){var o=_;return function(a,i){if(o===b)throw Error("Generator is already running");if(o===g){if("throw"===a)throw i;return{value:t,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=A(c,r);if(s){if(s===w)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===_)throw o=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=b;var u=h(e,n,r);if("normal"===u.type){if(o=r.done?g:v,u.arg===w)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=g,r.method="throw",r.arg=u.arg)}}}function A(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),w;var a=h(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,w;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,w):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,w)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function F(e){if(e||""===e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(i.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(r(e)+" is not iterable")}return y.prototype=m,c($,"constructor",{value:m,configurable:!0}),c(m,"constructor",{value:y,configurable:!0}),y.displayName=p(m,d,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,p(e,d,"GeneratorFunction")),e.prototype=Object.create($),e},n.awrap=function(e){return{__await:e}},S(O.prototype),p(O.prototype,l,(function(){return this})),n.AsyncIterator=O,n.async=function(e,t,r,o,a){void 0===a&&(a=Promise);var i=new O(f(e,t,r,o),a);return n.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S($),p($,d,"Generator"),p($,u,(function(){return this})),p($,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=F,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,w):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),w}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;C(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:F(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),w}},n}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},8545:function(e,t,n){"use strict";n.d(t,{EQ:function(){return a},Iu:function(){return c},Jq:function(){return i},Tv:function(){return o}});n(54756);var r=n(18987);function o(e){if(!e.ok)throw e;return e}function a(e){for(var t=0;t<e.length;++t)if(!e[t].ok)throw e[t];return e}function i(e,t,n){return void 0===t&&(t={}),void 0===n&&(n=null),t["X-CSRFToken"]=r.A.get("csrftoken"),fetch(e,{credentials:"include",headers:t,method:"POST",body:n})}function c(e,t,n){void 0===n&&(n=!1);var r="",o="";return n&&(r='<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',o="alert-dismissible"),'<div class="alert alert-'+e+" "+o+'" role="alert">'+t+r+"</div>"}},10467:function(e,t,n){"use strict";function r(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function c(e){r(i,o,a,c,s,"next",e)}function s(e){r(i,o,a,c,s,"throw",e)}c(void 0)}))}}n.d(t,{A:function(){return o}})},18987:function(e,t,n){"use strict";function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}n.d(t,{A:function(){return o}});var o=function e(t,n){function o(e,o,a){if("undefined"!=typeof document){"number"==typeof(a=r({},n,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var c in a)a[c]&&(i+="; "+c,!0!==a[c]&&(i+="="+a[c].split(";")[0]));return document.cookie=e+"="+t.write(o,e)+i}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},o=0;o<n.length;o++){var a=n[o].split("="),i=a.slice(1).join("=");try{var c=decodeURIComponent(a[0]);if(r[c]=t.read(i,c),e===c)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){o(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},38556:function(e,t){"use strict";var n=/^[-!#$%&'*+\/0-9=?A-Z^_a-z{|}~](\.?[-!#$%&'*+\/0-9=?A-Z^_a-z`{|}~])*@[a-zA-Z0-9](-*\.?[a-zA-Z0-9])*\.[a-zA-Z](-?[a-zA-Z0-9])+$/;t.t=function(e){if(!e)return!1;if(e.length>254)return!1;if(!n.test(e))return!1;var t=e.split("@");return!(t[0].length>64)&&!t[1].split(".").some((function(e){return e.length>63}))}},53056:function(module){module.exports=function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return null==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){null!=e&&(__output+=e)}with(locals||{})__append("\n\n"),cookingTask.swhid.match(/^swh:1:dir:.*/)?(__append('\n  <tr id="vault-task-'),__append(escapeFn(cookingTask.swhid)),__append('" title="Once downloaded, the directory can be extracted with the following command:\n\n$ tar xvzf '),__append(escapeFn(cookingTask.swhid.replaceAll(":","_"))),__append('.tar.gz">\n')):(__append('\n  </tr><tr id="vault-task-'),__append(escapeFn(cookingTask.swhid)),__append("\" title=\"Once downloaded, the git repository can be imported to a 'new_repository' directory with the following commands:\n\n$ tar xvf "),__append(escapeFn(cookingTask.swhid.replaceAll(":","_"))),__append(".git.tar\n$ git clone "),__append(escapeFn(cookingTask.swhid)),__append('.git new_repository\n$ cd new_repository/">\n')),__append('\n    <td>\n      <div class="form-check">\n      <input type="checkbox" class="form-check-input vault-task-toggle-selection" id="vault-task-toggle-selection-'),__append(escapeFn(cookingTask.swhid)),__append('">\n      <label class="form-check-label" for="vault-task-toggle-selection-'),__append(escapeFn(cookingTask.swhid)),__append('">\n      </label>\n    </div></td>\n    '),cookingTask.origin?(__append('\n      <td class="vault-origin">\n        <a href="'),__append(escapeFn(Urls.browse_origin())),__append("?origin_url="),__append(escapeFn(cookingTask.origin)),__append('">\n          '),__append(escapeFn(decodeURIComponent(cookingTask.origin))),__append("\n        </a>\n      </td>\n    ")):__append('\n      <td class="vault-origin">unknown</td>\n    '),__append('\n    <td>\n      <i class="'),__append(escapeFn(swh.webapp.getSwhObjectIcon(cookingTask.swhid.match(/swh:1:([a-z]+):/)[1]))),__append(' mdi-fw"></i>\n      '),__append(escapeFn(cookingTask.bundle_type)),__append('\n    </td>\n    <td class="vault-object-info" data-swhid="'),__append(escapeFn(cookingTask.swhid)),__append('">\n      <b>id:</b>&nbsp;<a href="'),__append(escapeFn(browseUrl)),__append('">'),__append(escapeFn(cookingTask.swhid)),__append("</a>\n      "),cookingTask.path&&(__append("\n        <br><b>path:</b>&nbsp;"),__append(escapeFn(cookingTask.path)),__append("\n      ")),__append("\n    </td>\n    <td>"),__append(progressBar.outerHTML),__append('</td>\n    <td class="vault-dl-link">\n      '),"done"===cookingTask.status&&(__append('\n        <button class="btn btn-secondary btn-sm" onclick="swh.vault.fetchCookedObject(\''),__append(escapeFn(cookingTask.fetch_url)),__append('\')">\n          <i class="mdi mdi-download mdi-fw" aria-hidden="true"></i>Download\n        </button>\n      ')),__append("\n    </td>\n  </tr>\n");return __output}},54756:function(e,t,n){var r=n(4633)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},73738:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},75097:function(e,t,n){"use strict";n.d(t,{Bn:function(){return _},hm:function(){return f},iF:function(){return w},jh:function(){return k}});var r,o,a=n(10467),i=n(54756),c=n.n(i),s=n(8545),u=n(53056),l=n.n(u),d=5e3;function p(e,t){"new"===t.status?e.css("background-color","rgba(128, 128, 128, 0.5)"):"pending"===t.status?e.css("background-color","rgba(0, 0, 255, 0.5)"):"done"===t.status?e.css("background-color","#5cb85c"):"failed"===t.status&&(e.css("background-color","rgba(255, 0, 0, 0.5)"),e.css("background-image","none"));var n,r,o=(t.progress_message||t.status).split("\n",2);n=o[0],r=o.slice(1),e.text(n),r.length&&e.prop("title",r[0]),"new"===t.status||"pending"===t.status?e.addClass("progress-bar-animated"):e.removeClass("progress-bar-striped")}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,a.A)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=null,e.next=3,fetch(t);case 3:if(!e.sent.ok){e.next=8;break}$("#vault-download-iframe").attr("src",t),e.next=19;break;case 8:if(!(n=JSON.parse(localStorage.getItem("swh-vault-cooking-tasks")))){e.next=18;break}r=0;case 11:if(!(r<n.length)){e.next=18;break}if(n[r].fetch_url!==t){e.next=15;break}return o=n[r],e.abrupt("break",18);case 15:++r,e.next=11;break;case 18:$("#vault-recook-object-modal").modal("show");case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return v.apply(this,arguments)}function v(){return(v=(0,a.A)(c().mark((function e(){var t,n,a,i,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=28;break}return clearTimeout(r),t="flat"===o.bundle_type?Urls.api_1_vault_cook_flat(o.swhid):Urls.api_1_vault_cook_git_bare(o.swhid),o.email&&(t+="?email="+o.email),e.prev=4,e.next=7,(0,s.Jq)(t);case 7:n=e.sent,(0,s.Tv)(n),o.status="new",a=JSON.parse(localStorage.getItem("swh-vault-cooking-tasks")),i=0;case 12:if(!(i<a.length)){e.next=19;break}if(a[i].swhid!==o.swhid){e.next=16;break}return a[i]=o,e.abrupt("break",19);case 16:++i,e.next=12;break;case 19:localStorage.setItem("swh-vault-cooking-tasks",JSON.stringify(a)),swh.vault.displayCookingTaskCreatedAlert(),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(4),swh.vault.displayCookingTaskCreationFailedAlert();case 26:e.next=31;break;case 28:u=$("#vault-recook-object-modal").attr("swh-object-type"),l=$("#vault-recook-object-modal").attr("swh-object-swhid"),"directory"===u?swh.vault.cookDirectoryArchive(null,l):"revision"===u&&swh.vault.cookRevisionArchive(null,l);case 31:return $("#vault-recook-object-modal").modal("hide"),e.next=34,b();case 34:case"end":return e.stop()}}),e,null,[[4,23]])})))).apply(this,arguments)}function b(){return g.apply(this,arguments)}function g(){return(g=(0,a.A)(c().mark((function e(){var t,n,o,a,i,u,f,h,_,v,g,w,k,y,m,x,T,j;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=JSON.parse(localStorage.getItem("swh-vault-cooking-tasks")))&&0!==t.length){e.next=5;break}return $(".swh-vault-table tbody tr").remove(),r=setTimeout(b,d),e.abrupt("return");case 5:n=[],o={},a=[],i=0;case 9:if(!(i<t.length)){e.next=36;break}if(void 0===(u=t[i]).object_type){e.next=28;break}if("directory"!==u.object_type){e.next=18;break}u.swhid="swh:1:dir:"+u.object_id,u.bundle_type="flat",u.fetch_url=Urls.api_1_vault_download_flat(u.swhid),e.next=26;break;case 18:if("revision"!==u.object_type){e.next=24;break}u.swhid="swh:1:rev:"+u.object_id,u.bundle_type="git_bare",u.fetch_url=Urls.api_1_vault_download_git_bare(u.swhid),e.next=26;break;case 24:return console.error("Unexpected cookingTask.object_type: "+u.object_type),e.abrupt("continue",33);case 26:delete u.object_type,delete u.object_id;case 28:a.push(u.swhid),o[u.swhid]=u,f=void 0,f="flat"===u.bundle_type?Urls.api_1_vault_cook_flat(u.swhid):Urls.api_1_vault_cook_git_bare(u.swhid),"done"!==u.status&&"failed"!==u.status&&n.push(fetch(f));case 33:++i,e.next=9;break;case 36:return $(".swh-vault-table tbody tr").each((function(e,t){var n=$(t).find(".vault-object-info").data("swhid");-1===$.inArray(n,a)&&$(t).remove()})),e.prev=37,e.next=40,Promise.all(n);case 40:return h=e.sent,(0,s.EQ)(h),e.next=44,Promise.all(h.map((function(e){return e.json()})));case 44:for(_=e.sent,v=$("#vault-cooking-tasks tbody"),g=0;g<_.length;++g)(w=o[_[g].swhid]).status=_[g].status,w.fetch_url=_[g].fetch_url,w.progress_message=_[g].progress_message;for(k=0;k<t.length;++k)y=t[k],(m=$("#vault-task-"+CSS.escape(y.swhid))).length?(p(m.find(".progress-bar"),y),j=m.find(".vault-dl-link"),"done"===y.status?j[0].innerHTML='<button class="btn btn-secondary btn-sm" onclick="swh.vault.fetchCookedObject(\''+y.fetch_url+'\')"><i class="mdi mdi-download mdi-fw" aria-hidden="true"></i>Download</button>':j[0].innerHTML=""):((x=y.browse_url)||(x=Urls.browse_swhid(y.swhid)),T=$.parseHTML('<div class="progress">\n    <div class="progress-bar progress-bar-success progress-bar-striped"\n          role="progressbar" aria-valuenow="100" aria-valuemin="0"\n          aria-valuemax="100" style="width: 100%;height: 100%;">\n    </div>\n  </div>;')[0],p($(T).find(".progress-bar"),y),v.prepend(l()({browseUrl:x,cookingTask:y,progressBar:T,Urls:Urls,swh:swh})));localStorage.setItem("swh-vault-cooking-tasks",JSON.stringify(t)),r=setTimeout(b,d),e.next=55;break;case 52:e.prev=52,e.t0=e.catch(37),console.log("Error when fetching vault cooking tasks:",e.t0);case 55:case"end":return e.stop()}}),e,null,[[37,52]])})))).apply(this,arguments)}function w(e){var t=JSON.parse(localStorage.getItem("swh-vault-cooking-tasks"));t&&(t=$.grep(t,(function(t){return-1===$.inArray(t.swhid,e)})),localStorage.setItem("swh-vault-cooking-tasks",JSON.stringify(t)))}function k(){$("#vault-tasks-toggle-selection").change((function(e){$(".vault-task-toggle-selection").prop("checked",e.currentTarget.checked)})),$("#vault-remove-tasks").click((function(){clearTimeout(r);var e=[];$(".swh-vault-table tbody tr").each((function(t,n){if($(n).find(".vault-task-toggle-selection").prop("checked")){var r=$(n).find(".vault-object-info").data("swhid");e.push(r),$(n).remove()}})),w(e),$("#vault-tasks-toggle-selection").prop("checked",!1),r=setTimeout(b,d)})),b(),window.onfocus=function(){clearTimeout(r),b()}}},94196:function(e,t,n){"use strict";n.d(t,{Ib:function(){return u},MO:function(){return g},OH:function(){return _},SI:function(){return l},aS:function(){return w},eo:function(){return v},mE:function(){return d}});var r=n(10467),o=n(54756),a=n.n(o),i=n(38556),c=n(8545),s={position:"fixed",left:"1rem",bottom:"1rem","z-index":"100000"};function u(){var e=$((0,c.Iu)("success",'Archive cooking request successfully submitted.<br/>Go to the <a class="alert-link" href="'+Urls.vault()+'">Downloads</a> page to get the download link once it is ready.',!0));e.css(s),$("body").append(e)}function l(){var e=$((0,c.Iu)("danger","Archive cooking request submission failed.",!0));e.css(s),$("body").append(e)}function d(e,t){return p.apply(this,arguments)}function p(){return(p=(0,r.A)(a().mark((function e(t,n){var r,o,i,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="directory"===t?Urls.api_1_vault_cook_flat(n):Urls.api_1_vault_cook_git_bare(n),e.next=3,fetch(r);case 3:return o=e.sent,e.next=6,o.json();case 6:i=e.sent,u=["failed","pending","new"],"NotFoundExc"===i.exception||u.includes(i.status)?(swh.vault.removeCookingTaskInfo([n]),$("#vault-cook-"+t+"-modal").modal("show")):"done"===i.status?$("#vault-download-"+t+"-modal").modal("show"):((l=$((0,c.Iu)("danger","Something unexpected happened when requesting the archive cooking service.<br/>Please try again later.",!0))).css(s),$("body").append(l));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e,t){return h.apply(this,arguments)}function h(){return(h=(0,r.A)(a().mark((function e(t,n){var r,o,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=swh.webapp.getSwhIdsContext(),n.origin=r[t].context.origin,n.path=r[t].context.path,n.browse_url=r[t].swhid_with_context_url,n.browse_url||(n.browse_url=r[t].swhid_url),(o=JSON.parse(localStorage.getItem("swh-vault-cooking-tasks")))||(o=[]),void 0!==o.find((function(e){return e.bundle_type===n.bundle_type&&e.swhid===n.swhid}))){e.next=27;break}return i="flat"===n.bundle_type?Urls.api_1_vault_cook_flat(n.swhid):Urls.api_1_vault_cook_git_bare(n.swhid),n.email&&(i+="?email="+encodeURIComponent(n.email)),e.prev=10,e.next=13,(0,c.Jq)(i);case 13:s=e.sent,(0,c.Tv)(s),o.push(n),localStorage.setItem("swh-vault-cooking-tasks",JSON.stringify(o)),$("#vault-cook-directory-modal").modal("hide"),$("#vault-cook-revision-modal").modal("hide"),u(),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(10),$("#vault-cook-directory-modal").modal("hide"),$("#vault-cook-revision-modal").modal("hide"),l();case 27:case"end":return e.stop()}}),e,null,[[10,22]])})))).apply(this,arguments)}function _(e,t){e&&e.preventDefault();var n=$("#swh-vault-directory-email").val().trim();!n||i.t(n)?f("directory",{bundle_type:"flat",swhid:t,email:n,status:"new"}):$("#invalid-email-modal").modal("show")}function v(e){return b.apply(this,arguments)}function b(){return(b=(0,r.A)(a().mark((function e(t){var n,r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $("#vault-download-directory-modal").modal("hide"),$("#vault-recook-object-modal").attr("swh-object-type","directory"),$("#vault-recook-object-modal").attr("swh-object-swhid",t),n=Urls.api_1_vault_cook_flat(t),e.next=6,fetch(n);case 6:return r=e.sent,e.next=9,r.json();case 9:o=e.sent,swh.vault.fetchCookedObject(o.fetch_url);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t){e&&e.preventDefault();var n=$("#swh-vault-revision-email").val().trim();!n||i.t(n)?f("revision",{bundle_type:"git_bare",swhid:t,email:n,status:"new"}):$("#invalid-email-modal").modal("show")}function w(e){return k.apply(this,arguments)}function k(){return(k=(0,r.A)(a().mark((function e(t){var n,r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $("#vault-download-revision-modal").modal("hide"),$("#vault-recook-object-modal").attr("swh-object-type","revision"),$("#vault-recook-object-modal").attr("swh-object-swhid",t),n=Urls.api_1_vault_cook_git_bare(t),e.next=6,fetch(n);case 6:return r=e.sent,e.next=9,r.json();case 9:o=e.sent,swh.vault.fetchCookedObject(o.fetch_url);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};return function(){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{cookDirectoryArchive:function(){return t.OH},cookRevisionArchive:function(){return t.MO},displayCookingTaskCreatedAlert:function(){return t.Ib},displayCookingTaskCreationFailedAlert:function(){return t.SI},fetchCookedObject:function(){return e.hm},fetchDirectoryArchive:function(){return t.eo},fetchRevisionArchive:function(){return t.aS},initUi:function(){return e.jh},recookObject:function(){return e.Bn},removeCookingTaskInfo:function(){return e.iF},vaultRequest:function(){return t.mE}});var e=__webpack_require__(75097),t=__webpack_require__(94196)}(),__webpack_exports__}()}));
//# sourceMappingURL=vault.51831610fdbf87be94b5.js.map