"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[4098],{94348:(e,a,t)=>{var n=t(29079),i=t(637),l=t.n(i),r=t(14867),s=t.n(r),o=t(97598),d=t.n(o),c=t(86326),m=t(35623),u=t(42430),f=t(6423),p=t(87597),y=t(56237),g=t(26225),E=t(46145),F=t(32341),b=t(96478),h=t(49528),w=t(18606);const v=n.Ay.bind(null,{endpoint:"legal.display_privacy",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"privacy",isDynamic:!1}]}]},"/"),k=n.Ay.bind(null,{endpoint:"legal.display_tos",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tos",isDynamic:!1}]}]},"/");function T({cancelURL:e,moderated:a,tosUrl:t,tos:n,privacyPolicyUrl:i,privacyPolicy:r,termsRequireAccept:o,termsEffectiveDate:d,initialValues:m,hasPredefinedAffiliations:T,allowCustomAffiliations:q,showAccountForm:A,showUsernameField:_,syncedValues:P,emails:C,affiliationMeta:S,hasPendingUser:M,mandatoryFields:U,lockedFields:V,lockedFieldMessage:I}){const L=()=>{const e=e=>e.stopPropagation(),a=t?c.createElement("a",{href:k(),rel:"noreferrer",target:"_blank",onClick:e}):c.createElement("span",null),l=i?c.createElement("a",{href:v(),rel:"noreferrer",target:"_blank",onClick:e}):c.createElement("span",null);return(n||t)&&(r||i)?c.createElement(b.Translate,null,"I have read, understood and accept the"," ",c.createElement(b.Param,{name:"tosLink",wrapper:a},"terms of service")," ","and"," ",c.createElement(b.Param,{name:"privacyLink",wrapper:l},"privacy policy"),"."):n||t?c.createElement(b.Translate,null,"I have read, understood and accept the"," ",c.createElement(b.Param,{name:"tosLink",wrapper:a},"terms of service"),"."):r||i?c.createElement(b.Translate,null,"I have read, understood and accept the"," ",c.createElement(b.Param,{name:"privacyLink",wrapper:l},"privacy policy"),"."):void 0};return c.createElement(u.Form,{onSubmit:async(e,a)=>{const t=(0,E.getValuesForFields)(e,a);let n;delete t.password_confirm,T?t.affiliation_data&&(t.affiliation=t.affiliation_data.text.trim(),t.affiliation_id=t.affiliation_data.id,delete t.affiliation_data):delete t.affiliation_data;try{n=await h.indicoAxios.post(location.href,t)}catch(e){return(0,E.handleSubmitError)(e,T?{affiliation:"affiliation_data"}:{})}location.href=n.data.redirect,await new Promise((()=>{}))},initialValues:m,initialValuesEqual:l().isEqual,subscription:{submitting:!0},validate:e=>{const a={};return e.password&&e.password_confirm&&e.password_confirm!==e.password&&(a.password_confirm=b.Translate.string("Passwords must match")),a}},(m=>c.createElement(f.A,{onSubmit:m.handleSubmit},!A&&c.createElement(u.Field,{name:"synced_fields",isEqual:l().isEqual,render:()=>null}),M&&c.createElement(p.A,{info:!0},c.createElement(b.Translate,null,"There is already some information in Indico that concerns you. We are going to link it automatically.")),c.createElement(F.Fieldset,{legend:b.Translate.string("User information"),active:A||a},C.length>1?c.createElement(g.SyncedFinalDropdown,{name:"email",label:b.Translate.string("Email address"),options:C.map((e=>({key:e,value:e,text:e}))),syncedValues:P,lockedFields:V,lockedFieldMessage:I,required:!0}):c.createElement(g.SyncedFinalInput,{name:"email",label:b.Translate.string("Email address"),syncedValues:P,lockedFields:V,lockedFieldMessage:I,readOnly:!0}),c.createElement(f.A.Group,{widths:"equal"},c.createElement(g.SyncedFinalInput,{name:"first_name",label:b.Translate.string("First name"),required:!0,syncedValues:P,lockedFields:V,lockedFieldMessage:I}),c.createElement(g.SyncedFinalInput,{name:"last_name",label:b.Translate.string("Last name"),required:!0,syncedValues:P,lockedFields:V,lockedFieldMessage:I})),T?c.createElement(g.SyncedFinalAffiliationDropdown,{name:"affiliation_data",required:a&&U.includes("affiliation"),syncName:"affiliation",syncedValues:P,lockedFields:V,lockedFieldMessage:I,currentAffiliation:S,allowCustomAffiliations:q}):c.createElement(g.SyncedFinalInput,{name:"affiliation",label:b.Translate.string("Affiliation"),required:a&&U.includes("affiliation"),syncedValues:P,lockedFields:V,lockedFieldMessage:I}),"address"in P&&c.createElement(g.SyncedFinalTextArea,{name:"address",label:b.Translate.string("Address"),syncedValues:P,lockedFields:V,lockedFieldMessage:I}),"phone"in P&&c.createElement(g.SyncedFinalInput,{name:"phone",label:b.Translate.string("Phone number"),syncedValues:P,lockedFields:V,lockedFieldMessage:I})),A&&c.createElement(F.Fieldset,{legend:b.Translate.string("Login details")},_&&c.createElement(E.FinalInput,{name:"username",label:b.Translate.string("Username"),required:!0}),c.createElement(f.A.Group,{widths:"equal"},c.createElement(E.FinalInput,{name:"password",type:"password",label:b.Translate.string("Password"),autoComplete:"new-password",required:!0}),c.createElement(E.FinalInput,{name:"password_confirm",type:"password",label:b.Translate.string("Confirm password"),autoComplete:"new-password",required:!0})),(0,w.renderPluginComponents)("signup-form-after-password")),a&&c.createElement(F.Fieldset,{legend:b.Translate.string("Account moderation")},c.createElement(p.A,{info:!0},c.createElement(b.Translate,null,"Each new account needs to be approved by an administrator. We will send you an email as soon as your request has been approved.")),c.createElement(F.FinalTextArea,{required:U.includes("comment"),name:"comment",initialValue:"",label:b.Translate.string("Comment"),description:b.Translate.string("You can provide additional information or a comment for the administrators who will review your registration.")})),o&&!!n&&!t&&c.createElement(F.Fieldset,{legend:b.Translate.string("Terms of service")},c.createElement("div",{className:"field policy editor-output",dangerouslySetInnerHTML:{__html:n}})),o&&!!r&&!i&&c.createElement(F.Fieldset,{legend:b.Translate.string("Privacy Policy")},c.createElement("div",{className:"field policy editor-output",dangerouslySetInnerHTML:{__html:r}})),o&&!!d&&c.createElement("div",{className:"field"},c.createElement(b.Translate,null,"Last updated"),": ",s()(d).format("LL")),o&&c.createElement(F.FinalCheckbox,{name:"accept_terms",required:!0,label:c.createElement("label",null,L())}),c.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},c.createElement(E.FinalSubmitButton,{disabledUntilChange:!1,label:a?b.Translate.string("Submit registration request"):b.Translate.string("Create my Indico profile"),className:"submit-button"}),c.createElement(f.A.Field,{disabled:m.submitting},c.createElement(y.A,{as:"a",href:e,disabled:m.submitting},c.createElement(b.Translate,null,"Cancel")))))))}T.propTypes={cancelURL:d().string.isRequired,moderated:d().bool.isRequired,tos:d().string,tosUrl:d().string,privacyPolicy:d().string,privacyPolicyUrl:d().string,termsRequireAccept:d().bool,termsEffectiveDate:d().string,initialValues:d().object.isRequired,hasPredefinedAffiliations:d().bool.isRequired,allowCustomAffiliations:d().bool.isRequired,showAccountForm:d().bool.isRequired,showUsernameField:d().bool,syncedValues:d().object.isRequired,emails:d().arrayOf(d().string).isRequired,affiliationMeta:d().object,hasPendingUser:d().bool,mandatoryFields:d().arrayOf(d().string).isRequired,lockedFields:d().arrayOf(d().string),lockedFieldMessage:d().string},T.defaultProps={tos:"",tosUrl:"",privacyPolicy:"",privacyPolicyUrl:"",termsRequireAccept:!1,termsEffectiveDate:null,showUsernameField:!1,affiliationMeta:null,hasPendingUser:!1,lockedFields:[],lockedFieldMessage:""},document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#signup-container");if(!e)return;const a=JSON.parse(e.dataset.config);m.render(c.createElement(T,a),e)}))}},e=>{e.O(0,[4644,4394,2076],(()=>{return a=94348,e(e.s=a);var a}));e.O()}]);
//# sourceMappingURL=module_auth.signup.563ba393.bundle.js.map