(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4154],{58095:function(e,t,s){var n=s(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,s){for(var n=-1,i=null==e?0:e.length;++n<i;)if(s(t,e[n]))return!0;return!1}},8817:function(e,t,s){var n=s(95372),i=s(1129),a=s(58263);e.exports=function(e,t,s){return t==t?a(e,t,s):n(e,i,s)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,s){var n=s(52485),i=s(58095),a=s(21796),r=s(65581),o=s(47111),l=s(43735);e.exports=function(e,t,s){var d=-1,c=i,u=e.length,m=!0,h=[],g=h;if(s)m=!1,c=a;else if(u>=200){var v=t?null:o(e);if(v)return l(v);m=!1,c=r,g=new n}else g=t?[]:h;e:for(;++d<u;){var p=e[d],y=t?t(p):p;if(p=s||0!==p?p:0,m&&y==y){for(var x=g.length;x--;)if(g[x]===y)continue e;t&&g.push(y),h.push(p)}else c(g,y,s)||(g!==h&&g.push(y),h.push(p))}return h}},47111:function(e,t,s){var n=s(46151),i=s(50344),a=s(43735),r=n&&1/a(new n([,-0]))[1]==1/0?function(e){return new n(e)}:i;e.exports=r},58263:function(e){e.exports=function(e,t,s){for(var n=s-1,i=e.length;++n<i;)if(e[n]===t)return n;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,s){var n=s(92198);e.exports=function(e){return e&&e.length?n(e):[]}},25654:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/[monitorId]/[systemId]",function(){return s(24331)}])},35287:function(e,t,s){"use strict";var n=s(24246),i=s(77181),a=s(88038),r=s.n(a);s(27378),t.Z=e=>{let{children:t,title:s,mainProps:a}=e;return(0,n.jsxs)(i.kCb,{"data-testid":s,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 240px)",children:[(0,n.jsxs)(r(),{children:[(0,n.jsxs)("title",{children:["Fides Admin UI - ",s]}),(0,n.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)(i.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...a,children:t})]})}},58754:function(e,t,s){"use strict";var n=s(24246),i=s(77181),a=s(70788);t.Z=e=>{let{heading:t,breadcrumbItems:s,isSticky:r=!0,children:o,rightContent:l,style:d,...c}=e;return(0,n.jsxs)("div",{...c,style:r?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,n.jsxs)(i.jqI,{justify:"space-between",children:["string"==typeof t?(0,n.jsx)(i.X6q,{className:s||o?"pb-4":void 0,fontSize:"2xl","data-testid":"page-heading",children:t}):t,l&&(0,n.jsx)("div",{"data-testid":"page-header-right-content",children:l})]}),!!s&&(0,n.jsx)(a.m,{className:o?"pb-4":void 0,items:s,"data-testid":"page-breadcrumb"}),o]})}},97181:function(e,t,s){"use strict";s.d(t,{d:function(){return d}});var n=s(24246),i=s(77181),a=s(34090),r=s(27378),o=s(91613),l=s(40324);let d=e=>{let{name:t,label:s,labelProps:d,tooltip:c,isRequired:u,layout:m="inline",...h}=e,[g,v,{setValue:p}]=(0,a.U$)(t),y=!!(v.touched&&v.error),[x,f]=(0,r.useState)("");g.value||"tags"!==h.mode&&"multiple"!==h.mode||(g.value=[]),"tags"===h.mode&&"string"==typeof g.value&&(g.value=[g.value]);let j="tags"===h.mode?(e,t)=>e?e.value!==x||g.value.includes(x)?h.optionRender?h.optionRender(e,t):e.label:'Create "'.concat(x,'"'):void 0:h.optionRender||void 0,b=e=>{f(e),h.onSearch&&h.onSearch(e)},C=(e,t)=>{p(e),h.onChange&&h.onChange(e,t)};return"inline"===m?(0,n.jsx)(i.NIc,{isInvalid:y,isRequired:u,children:(0,n.jsxs)(i.rjZ,{templateColumns:s?"1fr 3fr":"1fr",children:[s?(0,n.jsx)(l.__,{htmlFor:h.id||t,...d,children:s}):null,(0,n.jsxs)(i.jqI,{align:"center",children:[(0,n.jsxs)(i.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,n.jsx)(i.WPr,{...g,id:h.id||t,"data-testid":"controlled-select-".concat(g.name),...h,optionRender:j,onSearch:"tags"===h.mode?b:void 0,onChange:C,value:g.value||void 0,status:y?"error":void 0}),(0,n.jsx)(l.Bc,{isInvalid:y,message:v.error,fieldName:g.name})]}),c?(0,n.jsx)(o.Z,{label:c}):null]})]})}):(0,n.jsx)(i.NIc,{isInvalid:y,isRequired:u,children:(0,n.jsxs)(i.gCW,{alignItems:"start",children:[(0,n.jsxs)(i.jqI,{align:"center",children:[s?(0,n.jsx)(l.__,{htmlFor:h.id||t,fontSize:"xs",my:0,mr:1,...d,children:s}):null,c?(0,n.jsx)(o.Z,{label:c}):null]}),(0,n.jsx)(i.WPr,{...g,id:h.id||t,"data-testid":"controlled-select-".concat(g.name),...h,optionRender:j,onSearch:"tags"===h.mode?b:void 0,onChange:C,value:g.value||void 0,status:y?"error":void 0}),(0,n.jsx)(l.Bc,{isInvalid:y,message:v.error,fieldName:g.name})]})})}},14047:function(e,t,s){"use strict";s.d(t,{H:function(){return a},V:function(){return n.V}});var n=s(84306),i=s(812);let a=()=>{let{errorAlert:e}=(0,n.V)();return{handleError:t=>{let s="An unexpected error occurred. Please try again.";(0,i.Ot)(t)?s=t.data.detail:(0,i.tB)(t)&&(s=t.data.detail[0].msg),e(s)}}}},84306:function(e,t,s){"use strict";s.d(t,{V:function(){return a}});var n=s(24246),i=s(77181);let a=()=>{let e=(0,i.pmc)();return{errorAlert:(t,s,a)=>{let r={...a,position:(null==a?void 0:a.position)||"top",render:e=>{let{onClose:a}=e;return(0,n.jsxs)(i.bZj,{alignItems:"normal",status:"error","data-testid":"error-alert",children:[(0,n.jsx)(i.zMQ,{}),(0,n.jsxs)(i.xuv,{children:[s&&(0,n.jsx)(i.CdC,{children:s}),(0,n.jsx)(i.XaZ,{children:t})]}),(0,n.jsx)(i.PZ7,{onClick:a,position:"relative",right:0,size:"sm",top:-1})]})}};(null==a?void 0:a.id)&&e.isActive(a.id)?e.update(a.id,r):e(r)},successAlert:(t,s,a)=>{let r={...a,position:(null==a?void 0:a.position)||"top",render:e=>{let{onClose:a}=e;return(0,n.jsxs)(i.bZj,{alignItems:"normal",status:"success",variant:"subtle","data-testid":"success-alert",children:[(0,n.jsx)(i.zMQ,{}),(0,n.jsxs)(i.xuv,{children:[s&&(0,n.jsx)(i.CdC,{children:s}),(0,n.jsx)(i.XaZ,{children:t})]}),(0,n.jsx)(i.PZ7,{onClick:a,position:"relative",right:0,size:"sm",top:-1})]})}};(null==a?void 0:a.id)&&e.isActive(a.id)?e.update(a.id,r):e(r)}}}},45938:function(e,t,s){"use strict";s.d(t,{Gt:function(){return m},eB:function(){return h},oI:function(){return u}});var n=s(24246),i=s(34090),a=s(27378),r=s(16134),o=s(38602),l=s(58452);let d=(0,a.createRef)(),c=(0,a.createRef)(),u=()=>{let e=(0,r.T)(),t=(0,r.C)(o.DB),s=(0,a.useCallback)(()=>{c.current=void 0,d.current=void 0},[]),n=(0,a.useCallback)(()=>{e((0,o.Mr)()),c.current&&(c.current(!0),s())},[e,s]),i=(0,a.useCallback)(()=>{e((0,o.Mr)()),c.current&&(c.current(!1),s())},[e,s]);return{attemptAction:(0,a.useCallback)(()=>t?(e((0,o.h7)()),d.current||(d.current=new Promise(e=>{c.current=e})),d.current):Promise.resolve(!0),[t,e]),onConfirm:n,onClose:i}},m=e=>{let{id:t,name:s}=e,{dirty:n}=(0,i.u6)(),l=(0,r.T)();return(0,a.useEffect)(()=>(l((0,o.Zu)({id:t,name:s})),()=>{l((0,o.dz)({id:t}))}),[l,t,s]),(0,a.useEffect)(()=>{l((0,o.$p)({id:t,isDirty:n}))},[n,l,t]),null},h=()=>{let{onConfirm:e,onClose:t}=u(),s=(0,r.C)(o.uv);return(0,n.jsx)(l.Z,{isOpen:s,onClose:t,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},8133:function(e,t,s){"use strict";var n=s(24246),i=s(77181);t.Z=e=>{let{title:t,children:s,isOpen:a,onClose:r,...o}=e;return(0,n.jsxs)(i.u_l,{isOpen:a,onClose:r,isCentered:!0,scrollBehavior:"inside",size:"xl",id:"add-modal",...o,children:[(0,n.jsx)(i.ZAr,{}),(0,n.jsxs)(i.hzk,{textAlign:"left",p:0,"data-testid":"add-modal-content",children:[(0,n.jsx)(i.xBx,{p:0,children:(0,n.jsx)(i.xuv,{backgroundColor:"gray.50",px:6,py:4,border:"1px",borderColor:"gray.200",borderTopRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center",children:(0,n.jsx)(i.X6q,{as:"h3",size:"sm",children:t})})}),(0,n.jsx)(i.fef,{pb:4,overflow:"auto",children:s})]})]})}},70788:function(e,t,s){"use strict";s.d(t,{m:function(){return d}});var n=s(24246),i=s(77181),a=s(79894),r=s.n(a),o=s(27378);let{Text:l}=i.AntTypography,d=e=>{let{items:t,...s}=e,a=(0,o.useMemo)(()=>null==t?void 0:t.map((e,s)=>{let a=s===t.length-1,o={...e},d=o.onClick&&!o.href;return("string"==typeof o.title&&(o.title=(0,n.jsx)(l,{style:{color:"inherit",maxWidth:a?void 0:400},ellipsis:!a,children:o.title})),d)?o.title=(0,n.jsx)(i.wpx,{type:"text",size:"small",icon:o.icon,onClick:o.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:o.title}):(o.icon&&(o.title=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"anticon align-text-bottom",children:o.icon}),o.title]})),o.href&&o.title&&(o.title=(0,n.jsx)(r(),{href:o.href,className:"ant-breadcrumb-link",children:o.title}),delete o.href)),o}),[t]);return(0,n.jsx)(i.zrq,{items:a,...s})}},37059:function(e,t,s){"use strict";s.d(t,{Ak:function(){return h},EY:function(){return c},Ud:function(){return a},Vr:function(){return g},WJ:function(){return o},nP:function(){return d},nS:function(){return u},rs:function(){return l},sX:function(){return m},wi:function(){return r}});var n=s(78780),i=s(16394);let{useGetAggregateMonitorResultsQuery:a,useGetDiscoveredSystemAggregateQuery:r,useGetDiscoveredAssetsQuery:o,useAddMonitorResultSystemsMutation:l,useIgnoreMonitorResultSystemsMutation:d,useAddMonitorResultAssetsMutation:c,useIgnoreMonitorResultAssetsMutation:u,useUpdateAssetsSystemMutation:m,useUpdateAssetsDataUseMutation:h,useUpdateAssetsMutation:g}=n.u.injectEndpoints({endpoints:e=>({getAggregateMonitorResults:e.query({query:e=>{let{page:t=1,size:s=20,search:n}=e;return{url:"/plus/discovery-monitor/aggregate-results",params:{page:t,size:s,search:n,diff_status:"addition"}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredSystemAggregate:e.query({query:e=>{let{key:t,page:s=1,size:n=20,search:i}=e;return{url:"/plus/discovery-monitor/system-aggregate-results",params:{monitor_config_id:t,page:s,size:n,search:i,diff_status:"addition"}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredAssets:e.query({query:e=>{let{key:t,system:s,page:n=1,size:i=20,search:a}=e;return{url:"/plus/discovery-monitor/".concat(t,"/results"),params:{resolved_system_id:s,page:n,size:i,search:a,diff_status:"addition",sort_by:"urn"}}},providesTags:()=>["Discovery Monitor Results"]}),addMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:s}=e,n=(0,i.du)(s,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/promote?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:s}=e,n=(0,i.du)(s,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/mute?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),addMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/promote?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/mute?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),updateAssetsSystem:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,system_key:e.systemKey}))}),invalidatesTags:["Discovery Monitor Results","System Assets"]}),updateAssetsDataUse:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,data_uses:e.dataUses}))}),invalidatesTags:["Discovery Monitor Results"]}),updateAssets:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.assets}),invalidatesTags:["Discovery Monitor Results"]})})})},26183:function(e,t,s){"use strict";var n=s(24246);s(27378),t.Z=e=>{let{children:t,className:s,...i}=e;return(0,n.jsx)("div",{className:"relative flex w-full flex-wrap items-center gap-2 overflow-x-auto py-2 ".concat(s||""),...i,children:t})}},33335:function(e,t,s){"use strict";s.d(t,{E:function(){return n}});let n=e=>e.toLowerCase().replace(/ /g,"_").replace(/[^a-zA-Z0-9._<>-]/g,"")},36345:function(e,t,s){"use strict";s.d(t,{Z:function(){return p}});var n=s(24246),i=s(77181),a=s(34090),r=s(27378),o=s(16134),l=s(40324);let d=(0,i.IUT)({displayName:"CompassIcon",viewBox:"0 0 512 512",path:(0,n.jsx)("path",{fill:"currentColor",d:"M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm306.7 69.1L162.4 380.6c-19.4 7.5-38.5-11.6-31-31l55.5-144.3c3.3-8.5 9.9-15.1 18.4-18.4l144.3-55.5c19.4-7.5 38.5 11.6 31 31L325.1 306.7c-3.2 8.5-9.9 15.1-18.4 18.4zM288 256a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"})});var c=s(91613),u=s(57865);let{Text:m}=i.AntTypography,h=e=>{let{searchText:t,suggestion:s,...i}=e;return t&&s?(0,n.jsxs)(m,{"aria-hidden":!0,style:{pointerEvents:"none",position:"absolute",zIndex:10,top:"var(--ant-line-width)",bottom:"var(--ant-line-width)",left:"var(--ant-padding-sm)",lineHeight:"calc(var(--ant-control-height) - var(--ant-line-width))"},...i,children:[(0,n.jsx)(m,{className:"text-transparent",children:t}),(0,n.jsx)(m,{type:"secondary",children:s.substring(t.length)})]}):null},g="Create new system",v=e=>{let{active:t,disabled:s,onRefreshSuggestions:a}=e,r={bg:t?"complimentary.500":"gray.100"};return(0,n.jsxs)(i.gCW,{children:[(0,n.jsx)(i.LZC,{minHeight:"18px"}),(0,n.jsxs)(i.v2r,{children:[(0,n.jsx)(i.j2t,{as:i.hU,size:"sm",isDisabled:s,icon:(0,n.jsx)(d,{color:t?"white":"gray.700",boxSize:4}),"aria-label":"Update information from Compass","data-testid":"refresh-suggestions-btn",_hover:{_disabled:r},...r}),(0,n.jsx)(i.qyq,{children:(0,n.jsx)(i.sNh,{onClick:a,children:(0,n.jsx)(i.xvT,{fontSize:"xs",lineHeight:4,children:"Reset to Compass defaults"})})})]})]})};var p=e=>{var t,s;let{label:d,isCreate:m,lockedForGVL:p,options:y,isLoading:x,onVendorSelected:f}=e,j=(0,o.C)(u.bN),[b,C,{setValue:w}]=(0,a.U$)("name"),S=!!(C.touched&&C.error),_={...b,value:null!==(t=b.value)&&void 0!==t?t:""},{touched:k,values:R,setTouched:I,setFieldValue:A,validateForm:T}=(0,a.u6)(),[P,z]=(0,r.useState)(!0),q=null!==(s=y.find(e=>e.value===_.value))&&void 0!==s?s:{label:_.value,value:_.value,description:""},D=(e,t)=>!!(null==t?void 0:t.label.toLowerCase().startsWith(e.toLowerCase())),[N,Z]=(0,r.useState)(""),M=(0,r.useMemo)(()=>y.filter(e=>D(N,e)),[y,N]),E=(0,r.useMemo)(()=>{let e=y;return m&&N&&(e=[...y,{label:"".concat(g,' "').concat(N,'"...'),value:N}]),e},[m,y,N]),L=!!N&&M.length>0,V=p&&!m;(0,r.useEffect)(()=>{z(!_.value&&!R.vendor_id)},[_.value,R.vendor_id,z]),(0,r.useEffect)(()=>{T()},[P,T]);let U=async()=>{Z(""),A("vendor_id",void 0),await w(""),I({...k,vendor_id:!1,name:!1}),f(void 0)},W=async e=>{if(e){let t=y.some(t=>t.value===e.value)?e.value:void 0;A("vendor_id",t),await w(e.label.startsWith(g)?e.value:e.label),I({...k,vendor_id:!0,name:!0}),f(t)}},B=async e=>{_.onBlur(e),N&&await w(N),I({...k,name:!0})},O=async e=>{M.length>0&&N!==M[0].label?(e.preventDefault(),Z(M[0].label),A("vendor_id",M[0].value),await w(M[0].label),f(M[0].value)):(A("vendor_id",void 0),await w(N)),I({...k,name:!0})},F=(0,n.jsx)(i.NIc,{isInvalid:S,isRequired:!0,width:"100%",children:(0,n.jsxs)(i.gCW,{alignItems:"start",position:"relative",width:"100%",children:[(0,n.jsxs)(i.Ugi,{spacing:1,children:[(0,n.jsx)(l.__,{htmlFor:"vendorName",fontSize:"xs",my:0,mr:1,children:d}),(0,n.jsx)(c.Z,{label:"Enter the system name"})]}),(0,n.jsxs)(i.xuv,{width:"100%",className:"relative",children:[(0,n.jsx)(i.WPr,{id:"vendorName",labelInValue:!0,autoFocus:!0,allowClear:!0,options:E,loading:x,filterOption:(e,t)=>D(e,t)||!!(null==t?void 0:t.label.startsWith(g)),optionFilterProp:"label",value:q,placeholder:"Enter system name...",disabled:V,onChange:W,onSearch:Z,onClear:U,onBlur:B,onInputKeyDown:e=>{N&&"Tab"===e.key&&O(e)},status:S?"error":void 0,"data-testid":"vendor-name-select"}),(0,n.jsx)(h,{searchText:N,suggestion:M.length?M[0].label:""})]}),(0,n.jsx)(l.Bc,{isInvalid:S,message:C.error,fieldName:"name"})]})});return(0,n.jsxs)(i.Ugi,{alignItems:"flex-start",width:"full",children:[P?F:(0,n.jsx)(l.j0,{autoFocus:!0,id:"name",name:"name",label:"System name",tooltip:"Enter the system name",variant:"stacked",disabled:V,isRequired:!0,inputRightElement:V?null:(0,n.jsx)(i.PZ7,{onClick:U,size:"sm","data-testid":"clear-btn"})}),(0,n.jsx)(v,{active:!!R.vendor_id||L,disabled:!R.vendor_id||"showing"===j,onRefreshSuggestions:()=>f(R.vendor_id)})]})}},24331:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ei}});var n=s(24246),i=s(86677),a=s(27378),r=s(35287),o=s(77830),l=s(58754),d=s(59003),c=s(92222),u=s(77181),m=s(83766),h=s.n(m),g=s(812),v=s(14047),p=s(14481),y=s(37059),x=s(8133),f=s(70682);let{Text:j}=u.AntTypography;var b=e=>{let{onSave:t,isSaving:s,onClose:i,...r}=e,[o,l]=(0,a.useState)([]),d=()=>{l([]),i()};return(0,n.jsxs)(x.Z,{title:"Add consent category",...r,onClose:d,children:[(0,n.jsxs)(u.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(j,{children:"Assign consent categories to selected assets. This configures the system for consent management. Consent categories apply to both individual assets and the system."}),(0,n.jsx)(f.Z,{mode:"tags",selectedTaxonomies:o,onSelect:(e,t)=>l([...o,t.value]),variant:"outlined"})]}),(0,n.jsxs)(u.jqI,{justify:"space-between",children:[(0,n.jsx)(u.wpx,{htmlType:"reset",onClick:d,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(u.wpx,{htmlType:"submit",type:"primary",disabled:!o.length,loading:s,onClick:()=>t(o),"data-testid":"save-btn",children:"Save"})]})]})},C=s(57454),w=s(65450);let S=e=>{let{children:t,className:s,style:i,...a}=e;return(0,n.jsx)(u.wpx,{...a,type:"text",className:"w-full justify-start ".concat(s),style:{fontWeight:600,padding:"var(--ant-select-option-padding)",backgroundColor:"var(--ant-select-option-selected-bg)",...i},children:t})};var _=s(16394);let k=(e,t)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S,{onClick:t,"data-testid":"add-new-system",id:"add-new-system",children:"Add new system +"}),e]}),R=e=>{var t;let{onAddSystem:s,...i}=e,[r,o]=(0,a.useState)(),{data:l,isFetching:d}=(0,w.xF)({page:1,size:25,search:r||void 0}),c=null==l?void 0:null===(t=l.items)||void 0===t?void 0:t.map(e=>({value:e.fides_key,label:e.name})),m=(0,a.useCallback)(e=>{(null==e?void 0:e.length)>1&&o(e),(null==e?void 0:e.length)===0&&o(void 0)},[o]),h=(0,a.useMemo)(()=>(0,_.Ds)(m,300),[m]);return(0,n.jsx)(u.WPr,{placeholder:"Search...","aria-label":"Search for a system to select",dropdownStyle:{minWidth:"500px"},dropdownRender:s?e=>k(e,s):void 0,"data-testid":"system-select",...i,filterOption:!1,options:c,onSearch:h,loading:i.loading||d})};var I=s(34090),A=s(55484),T=s(16134),P=s(25980),z=s(97181),q=s(40324),D=s(45938),N=s(33335),Z=s(32885),M=s(57865),E=s(93237),L=s(36345);let{Text:V}=u.AntTypography,U={name:"",vendor_id:void 0,description:"",tags:[]},W=e=>{let{onSuccessfulSubmit:t,toastOnSuccess:s,...i}=e,[r,o]=(0,a.useState)(!1),l=(0,T.T)(),{tcf:d,dictionaryService:c}=(0,P.hz)(),{isLoading:m}=(0,Z.Rd)(void 0,{skip:!c}),h=(0,T.C)(Z.o),p=(0,T.C)(M.gU),[y]=(0,w.in)(),[f]=(0,Z.Qk)(),[j]=(0,w.f7)(),{successAlert:b,errorAlert:C}=(0,v.V)(),{setSuggestions:S,setLockedForGVL:_}=M.dictSuggestionsSlice.actions,k=(0,a.useRef)(null),R=(0,a.useMemo)(()=>A.Ry().shape({name:A.Z_().required().label("System name").test("is-unique","",async(e,t)=>{let{data:s}=await y({page:1,size:10,search:e});return!((null==s?void 0:s.items)||[]).filter(t=>t.name===e).some(t=>t.name===e)||t.createError({message:'You already have a system called "'.concat(e,'". Please specify a unique name for this system.')})})}),[y]),W=e=>{if(c){if(!e){l(S("hiding")),l(_(!1));return}l(S("showing")),d&&(0,g.cj)(e)===g.c6.GVL?l(_(!0)):l(_(!1))}},B=()=>{i.onClose(),l(S("initial")),l(_(!1))},O=async e=>{if(o(!0),e.vendor_id){let n=await f([e.vendor_id]);if((0,g.D4)(n))C((0,g.e$)(n.error));else{let{data:e}=n,i=e.systems[0];null==t||t(i.fides_key,i.name),s&&b("".concat(e.name," has been added to your system inventory."))}}else{let n={...e,fides_key:(0,N.E)(e.name),system_type:"",body:"",privacy_declarations:[]},i=await j(n);if((0,g.D4)(i))C((0,g.e$)(i.error));else{let{fides_key:n,name:a}=i.data;null==t||t(n,a),s&&b("".concat(e.name," has been added to your system inventory."))}B()}o(!1)};return(0,n.jsx)(x.Z,{title:"Add New System",...i,onClose:B,children:(0,n.jsx)(I.J9,{initialValues:U,onSubmit:O,validationSchema:R,innerRef:k,children:e=>{let{dirty:t,isValid:s}=e;return(0,n.jsxs)(I.l0,{children:[(0,n.jsx)(D.Gt,{id:"new-system-modal",name:"Add New System"}),(0,n.jsxs)(u.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(V,{children:"Fides will add this system to your inventory and configure it for consent using the categories of consent listed below. Optionally, you can check if this system is listed within the Fides compass library by selecting the compass icon below."}),c?(0,n.jsx)(L.Z,{label:"System name",options:h,onVendorSelected:W,isCreate:!0,lockedForGVL:p,isLoading:m}):(0,n.jsx)(q.j0,{id:"name",name:"name",label:"System name",tooltip:"Give the system a unique, and relevant name for reporting purposes. e.g. “Email Data Warehouse”",variant:"stacked",isRequired:!0}),(0,n.jsx)(E.Sv,{id:"description",name:"description",label:"Description",tooltip:"What services does this system perform?",disabled:p}),(0,n.jsx)(z.d,{mode:"tags",id:"tags",name:"tags",label:"System Tags",options:[],layout:"stacked",tooltip:"Are there any tags to associate with this system?",disabled:p})]}),(0,n.jsxs)(u.jqI,{justify:"space-between",children:[(0,n.jsx)(u.wpx,{htmlType:"reset",onClick:B,disabled:m||!t||!s,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(u.wpx,{htmlType:"submit",type:"primary",disabled:m||!t||!s,loading:r,"data-testid":"save-btn",children:"Save"})]})]})}})})},{Text:B}=u.AntTypography,O=e=>{let{onSave:t,isSaving:s,...i}=e,[r,o]=(0,a.useState)(),[l,d]=(0,a.useState)(!1),c=(0,a.useCallback)(e=>{e.preventDefault(),d(!0)},[]),m=()=>{d(!1)},h=()=>{o(void 0),i.onClose()};return(0,n.jsxs)(x.Z,{title:"Assign system",...i,onClose:h,children:[(0,n.jsxs)(u.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(B,{children:"Assign a system to the selected assets. If no system exists, select 'Add new system' to create one."}),(0,n.jsx)(R,{placeholder:"Search or select...",onSelect:(e,t)=>{o(t)},onAddSystem:c,value:r})]})," ",(0,n.jsxs)(u.jqI,{justify:"space-between",children:[(0,n.jsx)(u.wpx,{htmlType:"reset",onClick:h,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(u.wpx,{htmlType:"submit",type:"primary",disabled:!r,loading:s,onClick:()=>{t(r)},"data-testid":"save-btn",children:"Save"})]}),l&&(0,n.jsx)(W,{isOpen:!0,onClose:m,onSuccessfulSubmit:(e,t)=>{m(),o({label:t,value:e})},toastOnSuccess:!0})]})};var F=s(8411),$=s(72625);let H=e=>{let{asset:t}=e,[s,{isLoading:i}]=(0,y.EY)(),[a,{isLoading:r}]=(0,y.nS)(),{successAlert:o,errorAlert:l}=(0,v.V)(),d=i||r,{urn:c,name:m,resource_type:h}=t,p=async()=>{let e=await s({urnList:[c]});(0,g.D4)(e)?l((0,g.e$)(e.error)):o("".concat(h,' "').concat(m,'" has been added to the system inventory.'),"Confirmed")},x=async()=>{let e=await a({urnList:[c]});(0,g.D4)(e)?l((0,g.e$)(e.error)):o("".concat(h,' "').concat(m,'" has been ignored and will not appear in future scans.'),"Ignored")};return(0,n.jsxs)(u.vyj,{children:[(0,n.jsx)(u.esZ,{title:t.system?void 0:"This asset requires a system before you can add it to the inventory.",children:(0,n.jsx)(u.wpx,{"data-testid":"add-btn",size:"small",onClick:p,disabled:!t.system||d,loading:i,children:"Add"})}),(0,n.jsx)(u.wpx,{"data-testid":"ignore-btn",size:"small",onClick:x,disabled:d,loading:r,children:"Ignore"})]})};var G=s(34929),X=s(78238),J=s(26183),K=s(31883),Y=e=>{var t;let{asset:s}=e,[i,r]=(0,a.useState)(!1),[o]=(0,y.Ak)(),{successAlert:l,errorAlert:d}=(0,v.V)(),{getDataUseDisplayName:c}=(0,G.Z)(),m=async e=>{let t=s.data_uses||[],n=await o({monitorId:s.monitor_config_id,urnList:[s.urn],dataUses:[...t,e]});(0,K.D4)(n)?d((0,g.e$)(n.error)):l("Consent category added to ".concat(s.resource_type,' "').concat(s.name,'" .'),"Confirmed"),r(!1)},h=async e=>{let t=s.data_uses||[],n=await o({monitorId:s.monitor_config_id,urnList:[s.urn],dataUses:t.filter(t=>t!==e)});(0,K.D4)(n)?d((0,g.e$)(n.error)):l("Consent category removed from ".concat(s.resource_type,' "').concat(s.name,'".'),"Confirmed")},p=null===(t=s.data_uses)||void 0===t?void 0:t.filter(e=>(0,X.Z)(e));return(0,n.jsxs)(J.Z,{children:[!i&&(0,n.jsxs)(n.Fragment,{children:[null==p?void 0:p.map(e=>(0,n.jsx)(u.j8w,{"data-testid":"data-use-".concat(e),color:"white",closable:!0,onClose:()=>h(e),closeButtonLabel:"Remove data use",children:c(e)},e)),(0,n.jsx)(u.j8w,{onClick:()=>r(!0),"data-testid":"taxonomy-add-btn",addable:!0,"aria-label":"Add data use"})]}),i&&(0,n.jsx)(u.xuv,{className:"select-wrapper",position:"absolute",zIndex:10,top:"0",left:"0",width:"100%",height:"max",bgColor:"#fff",children:(0,n.jsx)(f.Z,{selectedTaxonomies:p||[],onSelect:m,onBlur:()=>r(!1),open:!0})})]})},Q=s(43862),ee=s(70675);let et=e=>{let{aggregateSystem:t,monitorConfigId:s}=e,{resource_type:i,name:r,urn:o,system:l,user_assigned_system_key:d,system_key:c}=t,[m,h]=(0,a.useState)(!1),[p,y]=(0,a.useState)(!1),[x,{isLoading:f}]=(0,ee.NA)(),{successAlert:j,errorAlert:b}=(0,v.V)(),C=(0,a.useCallback)(e=>{e.preventDefault(),y(!0)},[]),w=async(e,t,n)=>{let a=await x({staged_resource_urn:o,monitor_config_id:s,user_assigned_system_key:e});(0,g.D4)(a)?b((0,g.e$)(a.error)):j(n?"".concat(t," has been added to your system inventory and the ").concat(i,' "').concat(r,'" has been assigned to that system.'):"".concat(i,' "').concat(r,'" has been assigned to ').concat(t,"."),"Confirmed"),h(!1)};return(0,n.jsxs)(n.Fragment,{children:[!m&&(0,n.jsx)("div",{style:(0,Q.J9)(),children:l?(0,n.jsxs)(u.j8w,{onClick:()=>h(!0),"data-testid":"system-badge",children:[l,(0,n.jsx)(u.PJP.I8b,{})]}):(0,n.jsx)(u.j8w,{onClick:()=>h(!0),"data-testid":"add-system-btn",addable:!0})}),!!m&&(0,n.jsx)(R,{variant:"borderless",className:"w-full",autoFocus:!0,defaultOpen:!0,defaultValue:d||c,onBlur:e=>{var t;(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("id"))!=="add-new-system"&&h(!1)},onAddSystem:C,onSelect:(e,t)=>w(e,t.label),loading:f}),p&&(0,n.jsx)(W,{isOpen:!0,onClose:()=>{y(!1)},onSuccessfulSubmit:(e,t)=>w(e,t,!0)})]})},es=()=>{let e=(0,c.Cl)();return{columns:[e.display({id:"select",cell:e=>{let{row:t}=e;return(0,n.jsx)(p.k,{isChecked:t.getIsSelected(),onChange:t.getToggleSelectedHandler(),dataTestId:"select-".concat(t.original.name||t.id)})},header:e=>{let{table:t}=e;return(0,n.jsx)(p.k,{isChecked:t.getIsAllPageRowsSelected(),isIndeterminate:t.getIsSomeRowsSelected(),onChange:t.getToggleAllRowsSelectedHandler(),dataTestId:"select-all-rows"})},maxSize:40}),e.accessor(e=>e.name,{id:"name",cell:e=>(0,n.jsx)(p.G3,{value:e.getValue()}),header:"Asset",size:300}),e.accessor(e=>e.resource_type,{id:"resource_type",cell:e=>(0,n.jsx)(p.G3,{value:e.getValue()}),header:"Type"}),e.accessor(e=>e.system,{id:"system",cell:e=>!!e.row.original.monitor_config_id&&(0,n.jsx)(et,{aggregateSystem:e.row.original,monitorConfigId:e.row.original.monitor_config_id}),header:"System",size:200,meta:{noPadding:!0}}),e.display({id:"data_use",cell:e=>(0,n.jsx)(Y,{asset:e.row.original}),header:"Categories of consent",size:400,meta:{disableRowClick:!0}}),e.accessor(e=>e.locations,{id:"locations",cell:e=>(0,n.jsx)(p.G3,{value:e.getValue().length>1?"".concat(e.getValue().length," locations"):F.Z8[e.getValue()[0]]}),header:"Locations"}),e.accessor(e=>e.domain,{id:"domain",cell:e=>(0,n.jsx)(p.G3,{value:e.getValue()}),header:"Domain"}),e.accessor(e=>e.page,{id:"page",cell:e=>(0,n.jsx)($.tc,{values:e.getValue(),valueSuffix:"pages",cellProps:e}),header:e=>(0,n.jsx)($.Rr,{value:"Detected on",...e}),meta:{showHeaderMenu:!0,disableRowClick:!0}}),e.display({id:"actions",cell:e=>(0,n.jsx)(H,{asset:e.row.original}),header:"Actions",meta:{disableRowClick:!0}})]}},en=e=>{let{monitorId:t,systemId:s,onSystemName:r}=e,l=(0,i.useRouter)(),[m,x]=(0,a.useState)(s),[f,j]=(0,a.useState)({}),[w,S]=(0,a.useState)(!1),[_,k]=(0,a.useState)(!1),[R,{isLoading:I}]=(0,y.EY)(),[A,{isLoading:T}]=(0,y.nS)(),[P,{isLoading:z}]=(0,y.rs)(),[q,{isLoading:D}]=(0,y.sX)(),[N,{isLoading:Z}]=(0,y.Vr)(),M=I||T||z||D,E=M||s===o.Kl,{PAGE_SIZES:L,pageSize:V,setPageSize:U,onPreviousPageClick:W,isPreviousPageDisabled:B,onNextPageClick:F,isNextPageDisabled:$,startRange:H,endRange:G,pageIndex:X,setTotalPages:J,resetPageIndexToDefault:K}=(0,p.oi)(),[Y,Q]=(0,a.useState)(""),{successAlert:ee,errorAlert:et}=(0,v.V)();(0,a.useEffect)(()=>{K()},[t,Y,K]);let{data:en,isLoading:ei,isFetching:ea}=(0,y.WJ)({key:t,system:s,page:X,size:V,search:Y});(0,a.useEffect)(()=>{if(en){var e;let t=(null===(e=en.items[0])||void 0===e?void 0:e.system)||s||"";J(en.pages||1),x(t),null==r||r(t)}},[en,s,r,J]);let{columns:er}=es(),eo=(0,d.b7)({getCoreRowModel:(0,c.sC)(),columns:er,manualPagination:!0,data:(null==en?void 0:en.items)||[],columnResizeMode:"onChange",onRowSelectionChange:j,state:{rowSelection:f}}),el=eo.getSelectedRowModel().rows.map(e=>e.original.urn),ed=async()=>{let e=await R({urnList:el});(0,g.D4)(e)?et((0,g.e$)(e.error)):(eo.resetRowSelection(),ee("".concat(el.length," assets from ").concat(m," have been added to the system inventory."),"Confirmed"))},ec=async e=>{if("string"==typeof(null==e?void 0:e.value)){let s=await q({monitorId:t,urnList:el,systemKey:e.value});(0,g.D4)(s)?et((0,g.e$)(s.error)):(eo.resetRowSelection(),ee("".concat(el.length," assets have been assigned to ").concat(e.label,"."),"Confirmed"))}S(!1)},eu=async e=>{let s=null==en?void 0:en.items.filter(e=>el.includes(e.urn));if(!s)return;let n=s.map(t=>{let s=h()([...t.data_uses||[],...e]);return{urn:t.urn,data_uses:s}}),i=await N({monitorId:t,assets:n});(0,g.D4)(i)?et((0,g.e$)(i.error)):(eo.resetRowSelection(),ee("Consent categories added to ".concat(el.length," assets from ").concat(m,"."),"Confirmed"))},em=async()=>{let e=await A({urnList:el});(0,g.D4)(e)?et((0,g.e$)(e.error)):(eo.resetRowSelection(),ee("".concat(el.length," assets from ").concat(m," have been ignored and will not appear in future scans."),"Confirmed"))},eh=async()=>{let e=(null==en?void 0:en.items.length)||0,n=await P({monitor_config_key:t,resolved_system_ids:[s]});(0,g.D4)(n)?et((0,g.e$)(n.error)):(l.push("".concat(o.vi,"/").concat(t)),ee("".concat(e," assets from ").concat(m," have been added to the system inventory."),"Confirmed"))};return t&&s?ei?(0,n.jsx)(p.I4,{rowHeight:36,numRows:36}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.Q$,{children:[(0,n.jsx)(C.M,{value:Y,onChange:Q}),(0,n.jsxs)(u.kCb,{alignItems:"center",children:[!!el.length&&(0,n.jsx)(u.xvT,{fontSize:"xs",fontWeight:"semibold",minW:16,mr:6,"data-testid":"selected-count",children:"".concat(el.length," selected")}),(0,n.jsxs)(u.Ugi,{children:[(0,n.jsxs)(u.v2r,{children:[(0,n.jsx)(u.j2t,{as:u.wpx,icon:(0,n.jsx)(u.PJP._ME,{}),iconPosition:"end",loading:M,"data-testid":"bulk-actions-menu",disabled:!el.length||M,type:"primary",children:"Actions"}),(0,n.jsxs)(u.qyq,{children:[(0,n.jsx)(u.sNh,{fontSize:"small",onClick:ed,"data-testid":"bulk-add",children:"Add"}),(0,n.jsx)(u.sNh,{fontSize:"small",onClick:()=>k(!0),"data-testid":"bulk-add-data-use",children:"Add consent category"}),(0,n.jsx)(u.sNh,{fontSize:"small",onClick:()=>{S(!0)},"data-testid":"bulk-assign-system",children:"Assign system"}),(0,n.jsx)(u.RaW,{}),(0,n.jsx)(u.sNh,{fontSize:"small",onClick:em,"data-testid":"bulk-ignore",children:"Ignore"})]})]}),(0,n.jsx)(u.esZ,{title:E?"These assets require a system before you can add them to the inventory.":void 0,children:(0,n.jsx)(u.wpx,{onClick:eh,disabled:E,loading:z,type:"primary",icon:(0,n.jsx)(u.PJP.MCw,{}),iconPosition:"end","data-testid":"add-all",children:"Add all"})})]})]})]}),(0,n.jsx)(p.ZK,{tableInstance:eo,emptyTableNotice:(0,n.jsx)(u.oj8,{image:u.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})}),(0,n.jsx)(p.s8,{totalRows:(null==en?void 0:en.total)||0,pageSizes:L,setPageSize:U,onPreviousPageClick:W,isPreviousPageDisabled:B||ea,onNextPageClick:F,isNextPageDisabled:$||ea,startRange:H,endRange:G}),(0,n.jsx)(O,{isOpen:w,onClose:()=>{S(!1)},onSave:ec,isSaving:D}),(0,n.jsx)(b,{isOpen:_,onClose:()=>{k(!1)},onSave:eu,isSaving:Z})]}):null};var ei=()=>{let e=(0,i.useRouter)(),t=decodeURIComponent(e.query.monitorId),s=decodeURIComponent(e.query.systemId),[d,c]=(0,a.useState)(s===o.Kl?"Uncategorized assets":s);return(0,n.jsxs)(r.Z,{title:"Action center - Discovered assets",children:[(0,n.jsx)(l.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:o.vi},{title:t,href:"".concat(o.vi,"/").concat(t)},{title:s===o.Kl?"Uncategorized assets":d}]}),(0,n.jsx)(en,{monitorId:t,systemId:s,onSystemName:c})]})}},31883:function(e,t,s){"use strict";s.d(t,{Bw:function(){return n.Bw},D4:function(){return n.D4}});var n=s(19043)}},function(e){e.O(0,[8033,6060,2858,2866,9278,4481,7434,2888,9774,179],function(){return e(e.s=25654)}),_N_E=e.O()}]);