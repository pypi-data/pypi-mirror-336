(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8538],{73846:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dataset/new",function(){return a(17294)}])},812:function(e,t,a){"use strict";a.d(t,{D4:function(){return s.D4},MM:function(){return f},Ot:function(){return u},c6:function(){return r},cj:function(){return g},e$:function(){return l},fn:function(){return o},iC:function(){return y},nU:function(){return d},tB:function(){return c}});var n,r,s=a(19043);let i="An unexpected error occurred. Please try again.",l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if((0,s.Bw)(e)){if((0,s.hE)(e.data))return e.data.detail;if((0,s.cz)(e.data)){var a;let t=null===(a=e.data.detail)||void 0===a?void 0:a[0];return"".concat(null==t?void 0:t.msg,": ").concat(null==t?void 0:t.loc)}if(409===e.status&&(0,s.Dy)(e.data)||404===e.status&&(0,s.XD)(e.data))return"".concat(e.data.detail.error," (").concat(e.data.detail.fides_key,")")}return t};function o(e){return"object"==typeof e&&null!=e&&"status"in e}function u(e){return"object"==typeof e&&null!=e&&"data"in e&&"string"==typeof e.data.detail}function c(e){return"object"==typeof e&&null!=e&&"data"in e&&Array.isArray(e.data.detail)}let d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{status:500,message:i};if((0,s.oK)(e))return{status:e.originalStatus,message:e.data};if((0,s.Bw)(e)){let{status:a}=e;return{status:a,message:l(e,t.message)}}return t},f=e=>Object.entries(e).map(e=>({value:e[1],label:e[1]}));(n=r||(r={})).GVL="gvl",n.AC="gacp",n.COMPASS="compass";let y={gvl:{label:"GVL",fullName:"Global Vendor List"},gacp:{label:"AC",fullName:"Google Additional Consent List"},compass:{label:"",fullName:""}},g=e=>{let t=e.split(".")[0];return"gacp"===t?"gacp":"gvl"===t?"gvl":"compass"}},14047:function(e,t,a){"use strict";a.d(t,{H:function(){return s},V:function(){return n.V}});var n=a(84306),r=a(812);let s=()=>{let{errorAlert:e}=(0,n.V)();return{handleError:t=>{let a="An unexpected error occurred. Please try again.";(0,r.Ot)(t)?a=t.data.detail:(0,r.tB)(t)&&(a=t.data.detail[0].msg),e(a)}}}},58452:function(e,t,a){"use strict";var n=a(24246),r=a(56351);t.Z=e=>{let{isOpen:t,onClose:a,onConfirm:s,onCancel:i,title:l,message:o,cancelButtonText:u,continueButtonText:c,isLoading:d,returnFocusOnClose:f,isCentered:y,testId:g="confirmation-modal",icon:h}=e;return(0,n.jsxs)(r.u_l,{isOpen:t,onClose:a,size:"lg",returnFocusOnClose:null==f||f,isCentered:y,children:[(0,n.jsx)(r.ZAr,{}),(0,n.jsxs)(r.hzk,{textAlign:"center",p:6,"data-testid":g,children:[h?(0,n.jsx)(r.M5Y,{mb:2,children:h}):null,l?(0,n.jsx)(r.xBx,{fontWeight:"medium",pb:0,children:l}):null,o?(0,n.jsx)(r.fef,{children:o}):null,(0,n.jsx)(r.mzw,{children:(0,n.jsxs)(r.MIq,{columns:2,width:"100%",children:[(0,n.jsx)(r.wpx,{onClick:()=>{i&&i(),a()},size:"large",className:"mr-3","data-testid":"cancel-btn",disabled:d,children:u||"Cancel"}),(0,n.jsx)(r.wpx,{type:"primary",size:"large",onClick:s,"data-testid":"continue-btn",loading:d,children:c||"Continue"})]})})]})]})}},46628:function(e,t,a){"use strict";a.d(t,{MA:function(){return l},Vo:function(){return u},t5:function(){return o}});var n=a(24246),r=a(56351);let s=e=>{let{children:t,title:a="Success"}=e;return(0,n.jsxs)(r.xvT,{"data-testid":"toast-success-msg",children:[(0,n.jsxs)("strong",{children:[a,":"]})," ",t]})},i=e=>{let{children:t}=e;return(0,n.jsxs)(r.xvT,{"data-testid":"toast-error-msg",children:[(0,n.jsx)("strong",{children:"Error:"})," ",t]})},l={variant:"subtle",position:"top",description:"",duration:5e3,status:"success",isClosable:!0},o=(e,t)=>{let a=(0,n.jsx)(s,{title:t,children:e});return{...l,description:a}},u=e=>{let t=(0,n.jsx)(i,{children:e});return{...l,description:t,status:"error"}}},17294:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return O}});var n=a(24246),r=a(56351),s=a(27378),i=a(25980),l=a(77213),o=a(77830),u=a(58754),c=a(91613),d=a(34090),f=a(86677),y=a(45007),g=a(59389),h=a(40324),m=a(812),p=a(58452),x=a(46628),b=a(83265),v=a(32885),j=a(21702),w=a(20386);let C=e=>!("system_type"in e),_={url:"",classify:!1,classifyConfirmed:!1},A=g.Ry().shape({url:g.Z_().required().label("Database URL"),classify:g.O7(),classifyConfirmed:g.O7().when(["url","classify"],{is:(e,t)=>e&&t,then:()=>g.O7().equals([!0])})});var D=()=>{let[e,{isLoading:t}]=(0,w.pR)(),[a,{isLoading:s}]=(0,w.IR)(),[l,{isLoading:u}]=(0,v.Du)(),c=t||s||u,g=(0,r.pmc)(),D=(0,f.useRouter)(),L=(0,i.hz)(),S=(0,y.I0)(),k=async t=>{var a;let n=await e({organization_key:b.Av,generate:{config:{connection_string:t.url},target:j.GC.DB,type:j.j.DATASETS}});if("error"in n)return{error:(0,m.e$)(n.error)};let r=(null!==(a=n.data.generate_results)&&void 0!==a?a:[]).filter(C);return r&&r.length>0?{datasets:r}:{error:"Unable to generate a dataset with this connection."}},N=async e=>{let t=await a(e);return"error"in t?{error:(0,m.e$)(t.error)}:{dataset:t.data}},E=async e=>{let{values:t,datasets:a}=e,n=await l({dataset_schemas:a.map(e=>{let{name:t,fides_key:a}=e;return{fides_key:a,name:t}}),schema_config:{organization_key:b.Av,generate:{config:{connection_string:t.url},target:j.GC.DB,type:j.j.DATASETS}}});return"error"in n?{error:(0,m.e$)(n.error)}:{classifyInstances:n.data.classify_instances}},O=async e=>{var t;let a=await k(e);if("error"in a){g((0,x.Vo)(a.error));return}let n=await Promise.all(a.datasets.map(e=>N(e))),r=null!==(t=n.find(e=>"error"in e))&&void 0!==t?t:n[0];if("error"in r){g((0,x.Vo)(r.error));return}if(!e.classify){g((0,x.t5)("Generated ".concat(r.dataset.name," dataset"))),D.push({pathname:o.o5,query:{datasetId:r.dataset.fides_key}});return}let s=await E({values:e,datasets:a.datasets});if("error"in s){g((0,x.Vo)(s.error));return}g((0,x.t5)("Generate and classify are now in progress")),S((0,w.Zl)(r.dataset.fides_key)),D.push("/dataset")};return(0,n.jsx)(d.J9,{initialValues:{..._,classify:L.plus},validationSchema:A,onSubmit:O,validateOnChange:!1,validateOnBlur:!1,children:e=>{let{isSubmitting:t,errors:a,values:s,submitForm:i,resetForm:l,setFieldValue:o}=e;return(0,n.jsxs)(d.l0,{children:[(0,n.jsxs)(r.gCW,{spacing:8,align:"left",children:[(0,n.jsx)(r.xvT,{size:"sm",color:"gray.700",children:"Connect to a database using the connection URL. You may have received this URL from a colleague or your Ethyca developer support engineer."}),(0,n.jsx)(r.xuv,{children:(0,n.jsx)(h.j0,{name:"url",label:"Database URL"})}),L.plus?(0,n.jsx)(h.w8,{name:"classify",label:"Classify dataset",tooltip:"Use Fides Classify to suggest labels based on your data."}):null,(0,n.jsx)(r.xuv,{children:(0,n.jsx)(r.wpx,{type:"primary",htmlType:"submit",loading:t||c,disabled:t||c,"data-testid":"create-dataset-btn",children:"Generate dataset"})})]}),(0,n.jsx)(p.Z,{title:"Generate and classify this dataset",message:"You have chosen to generate and classify this dataset. This process may take several minutes. In the meantime you can continue using Fides. You will receive a notification when the process is complete.",isOpen:void 0!==a.classifyConfirmed,onClose:()=>{l({values:{...s,classifyConfirmed:!1}})},onConfirm:()=>{o("classifyConfirmed",!0),setTimeout(()=>{i()},0)}})]})}})},L=a(66527),S=a(14047),k=a(41207),N=a(39715),E=()=>{let[e]=(0,w.IR)(),[t,a]=(0,s.useState)(!0),[i,l]=(0,s.useState)(!1),[u,c]=(0,s.useState)(!1),d=(0,s.useRef)(null),y=(0,f.useRouter)(),g=(0,r.pmc)(),{errorAlert:h}=(0,S.V)(),[p,b]=(0,s.useState)(void 0),v=e=>{L.ZP.load(e,{json:!0}),b(void 0)},j=async t=>{let a;return"object"==typeof t&&null!=t&&"dataset"in t&&Array.isArray(t.dataset)?[a]=t.dataset:Array.isArray(t)?[a]=t:a=t,e(a)},C=e=>{g((0,x.t5)("Successfully loaded new dataset YAML")),(0,w.Zl)(e.fides_key),y.push({pathname:o.o5,query:{datasetId:e.fides_key}})},_=async()=>{l(!0);let e=d.current.getValue(),t=L.ZP.load(e,{json:!0}),a=await j(t);(0,m.D4)(a)?g((0,x.Vo)((0,m.e$)(a.error))):"data"in a&&C(a.data),l(!1)};return(0,n.jsxs)(r.kCb,{gap:"97px",children:[(0,n.jsxs)(r.xuv,{w:"75%",children:[(0,n.jsx)(r.xuv,{color:"gray.700",fontSize:"14px",mb:4,children:"Get started creating your first dataset by pasting your dataset yaml below! You may have received this yaml from a colleague or your Ethyca developer support engineer."}),(0,n.jsxs)(r.gCW,{align:"stretch",children:[(0,n.jsx)(r.izJ,{color:"gray.100"}),(0,n.jsx)(k.M,{defaultLanguage:"yaml",height:"calc(100vh - 515px)",onChange:e=>{try{c(!0),v(e),a(!!(!e||""===e.trim()))}catch(e){(0,k.F)(e)?b(e):h("Could not parse the supplied YAML")}},onMount:e=>{d.current=e,d.current.focus()},options:{fontFamily:"Menlo",fontSize:13,minimap:{enabled:!0}},theme:"light"}),(0,n.jsx)(r.izJ,{color:"gray.100"}),(0,n.jsx)(r.wpx,{type:"primary",disabled:t||!!p||i,loading:i,onClick:_,htmlType:"submit",className:"mt-6 w-fit",children:"Create dataset"})]})]}),(0,n.jsx)(r.xuv,{children:u&&(t||p)&&(0,n.jsx)(N.Z,{isEmptyState:t,yamlError:p})})]})},O=()=>{let e=(0,i.hz)(),[t,a]=(0,s.useState)(null);return(0,n.jsxs)(l.Z,{title:"Create New Dataset",children:[(0,n.jsx)(u.Z,{heading:"Datasets",breadcrumbItems:[{title:"All datasets",href:o.$m},{title:"Create new"}]}),(0,n.jsxs)(r.Kqy,{spacing:8,children:[(0,n.jsxs)(r.xuv,{children:[(0,n.jsx)(r.wpx,{onClick:()=>a("yaml"),"data-testid":"upload-yaml-btn",className:"mr-2",children:"Upload a Dataset YAML"}),(0,n.jsx)(r.wpx,{onClick:()=>a("database"),ghost:"database"===t,disabled:e.flags.dataDiscoveryAndDetection,className:"mr-2","data-testid":"connect-db-btn",children:"Connect to a database"}),e.flags.dataDiscoveryAndDetection?(0,n.jsx)(c.Z,{label:"Creating a dataset via a database connection is disabled when the 'detection & discovery' beta feature is enabled"}):null]}),"database"===t&&(0,n.jsx)(r.xuv,{w:{base:"100%",lg:"50%"},children:(0,n.jsx)(D,{})}),"yaml"===t&&(0,n.jsx)(r.xuv,{w:{base:"100%"},children:(0,n.jsx)(E,{})})]})]})}},19043:function(e,t,a){"use strict";a.d(t,{Bw:function(){return i},D4:function(){return r},Dy:function(){return o},XD:function(){return u},cz:function(){return c},hE:function(){return l},oK:function(){return s}});var n=a(76649);let r=e=>"error"in e,s=e=>(0,n.Ln)({status:"string"},e)&&"PARSING_ERROR"===e.status,i=e=>(0,n.Ln)({status:"number",data:{}},e),l=e=>(0,n.Ln)({detail:"string"},e),o=e=>(0,n.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),u=e=>(0,n.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),c=e=>(0,n.Ln)({detail:[{loc:["string","number"],msg:"string",type:"string"}]},e)},76649:function(e,t,a){"use strict";a.d(t,{Ln:function(){return n}});let n=(e,t)=>s(e,t),r=Symbol("SOME"),s=(e,t)=>"string"==typeof e?e===typeof t:Array.isArray(e)?r in e?e.some(e=>s(e,t)):!!Array.isArray(t)&&(0===e.length||t.every(t=>e.some(e=>s(e,t)))):"object"==typeof t&&null!==t&&Object.entries(e).every(([e,a])=>s(a,t[e]));class i{static narrow(e){return new i(t=>n(e,t))}constructor(e){this.NF=void 0,this.NF=e}satisfied(e){return this.NF(e)}build(e){return e}and(e){let t=this.NF,a=e instanceof i?e.NF:e instanceof Function?e:t=>n(e,t);return new i(e=>t(e)&&a(e))}}new i(e=>!0)}},function(e){e.O(0,[3005,5574,2888,9774,179],function(){return e(e.s=73846)}),_N_E=e.O()}]);