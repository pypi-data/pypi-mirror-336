import{a as n,t as p,b as l,h as Lt,d as ut,f as Nt,e as wt}from"../chunks/disclose-version.DmlnhT3J.js";import{i as Dt}from"../chunks/legacy.CoyMJ5xE.js";import{p as jt,t as c,a as $t,c as e,r as t,s as a,f as Z,o as Ot,l as Tt,b as It,g as r,d as L,m as Y}from"../chunks/index-client.DkPLSjuc.js";import{p as St,i as _}from"../chunks/props.BV9OlT46.js";import{a as mt,e as ft,i as bt}from"../chunks/index.CQk4rkOh.js";import{s as vt}from"../chunks/class.D2f2e0er.js";import{a as Jt}from"../chunks/index.CZsGPz6J.js";import{S as kt}from"../chunks/StatusBadge.BYFWD7xX.js";import{L as Mt}from"../chunks/Loading.DxVb729J.js";import{E as At}from"../chunks/ErrorDisplay.DEeUAJLj.js";import{S as Ct,E as Ht,t as zt}from"../chunks/EvaluationResults.Bg-VgX0u.js";import{f as Ft,i as Bt}from"../chunks/intervalToDuration.BpIG60gY.js";var Gt=p('<div><div class="text-2xl font-bold mb-1"><span> </span></div> <div>Tasks Passed</div> <div class="text-sm text-gray-500 mt-1"> </div></div>'),qt=p('<div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-gray-300"></div> <span> </span></div>'),Kt=p('<div class="flex gap-1 h-2 rounded-full overflow-hidden bg-gray-100 w-full"><div class="bg-green-500"></div> <div class="bg-red-500"></div> <div class="bg-gray-300"></div></div> <div class="flex gap-6 text-sm mt-2"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-green-500"></div> <span> </span></div> <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-red-500"></div> <span> </span></div> <!></div>',1),Qt=p('<div class="p-8 border-b"><div class="flex justify-between items-start mb-6"><div><h1 class="text-4xl font-bold mb-2"> </h1> <div class="text-gray-600"> </div></div> <!></div> <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-6"><div><h3 class="text-sm font-medium text-gray-500">Project</h3> <p class="mt-1 text-lg"> </p></div> <div><h3 class="text-sm font-medium text-gray-500">Status</h3> <p class="mt-1"><!></p></div> <div><h3 class="text-sm font-medium text-gray-500">Created</h3> <p class="mt-1 text-lg"> </p></div> <div><h3 class="text-sm font-medium text-gray-500">Model</h3> <p class="mt-1 text-lg"> </p></div></div> <!></div>');function Ut(nt,B){jt(B,!1);let h=St(B,"runDetails",8),i=St(B,"taskStats",8);Dt();var j=Qt(),y=e(j),$=e(y),k=e($),tt=e(k);c(()=>l(tt,`Run Report: ${h().id.slice(-8)??""}`)),t(k);var N=a(k,2),lt=e(N);c(()=>l(lt,`Generated on ${new Date().toLocaleString()??""}`)),t(N),t($);var g=a($,2);_(g,i,E=>{var m=Gt(),f=e(m),x=e(f),A=e(x);t(x),t(f);var R=a(f,2),w=a(R,2),S=e(w);c(()=>l(S,`Avg Score: ${(i().avgScore*100).toFixed(0)??""}%`)),t(w),t(m),c(()=>{vt(m,`text-center px-6 py-4 rounded-lg ${i().failed===0?"bg-green-50 border-2 border-green-200":"bg-red-50 border-2 border-red-200"}`),vt(x,i().failed===0?"text-green-600":"text-red-600"),l(A,`${i().completed??""}/${i().total??""}`),vt(R,`text-sm ${i().failed===0?"text-green-600":"text-red-600"}`)}),n(E,m)}),t(y);var o=a(y,2),b=e(o),O=a(e(b),2),et=e(O,!0);t(O),t(b);var G=a(b,2),T=a(e(G),2),I=e(T);kt(I,{get status(){return h().status}}),t(T),t(G);var J=a(G,2),M=a(e(J),2),ct=e(M,!0);c(()=>l(ct,new Date(h().date).toLocaleString())),t(M),t(J);var q=a(J,2),rt=a(e(q),2),pt=e(rt,!0);t(rt),t(q),t(o);var d=a(o,2);_(d,i,E=>{var m=Kt(),f=Z(m),x=e(f),A=a(x,2),R=a(A,2);t(f);var w=a(f,2),S=e(w),at=a(e(S),2),it=e(at);t(at),t(S);var C=a(S,2),dt=a(e(C),2),st=e(dt);t(dt),t(C);var ot=a(C,2);_(ot,()=>i().inProgress>0,K=>{var H=qt(),Q=a(e(H),2),gt=e(Q);t(Q),t(H),c(()=>l(gt,`${i().inProgress??""} in progress`)),n(K,H)}),t(w),c(()=>{mt(x,"style",`width: ${i().completed/i().total*100}%`),mt(A,"style",`width: ${i().failed/i().total*100}%`),mt(R,"style",`width: ${i().inProgress/i().total*100}%`),l(it,`${i().completed??""} completed`),l(st,`${i().failed??""} failed`)}),n(E,m)}),t(j),c(()=>{l(et,h().project.name),l(pt,h().details.model||"N/A")}),n(nt,j),$t()}var Vt=p(`<style>@media screen {
            body {
                background: white;
                margin: 0;
                padding: 0;
            }
        }
        @media print {
            @page {
                margin: 1.5cm;
                size: A4;
            }
            body {
                margin: 0;
                padding: 0;
                color: black;
                background: white;
                font-size: 11pt;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            .no-print {
                display: none !important;
            }
            /* Ensure backgrounds and colors are printed */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            /* Enhance borders for better print visibility */
            .border {
                border-width: 1.5px !important;
            }
            .border-b {
                border-bottom-width: 1.5px !important;
            }
            /* Enhance text contrast for print */
            .text-gray-500 {
                color: #4a5568 !important;
            }
            .text-gray-600 {
                color: #2d3748 !important;
            }
        }
        /* Hide header and footer */
        nav, footer, header {
            display: none !important;
        }</style>`),Wt=p('<div><h4 class="text-sm font-semibold mb-2">Input</h4> <div class="bg-gray-50 p-4 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"> </div></div>'),Xt=p('<div><h4 class="text-sm font-semibold mb-2">Output</h4> <div class="bg-gray-50 p-4 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"> </div></div>'),Yt=p('<div><div class="text-sm font-medium text-gray-600 mb-1"> </div> <div class="bg-gray-50 p-3 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"> </div></div>'),Zt=p('<div><h4 class="text-sm font-semibold mb-2">Details</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3"></div></div>'),te=p('<div><h4 class="text-sm font-semibold mb-3">Evaluation Results</h4> <!></div>'),ee=p('<div><div class="text-sm font-medium text-gray-600 mb-1"> </div> <div class="bg-gray-50 p-3 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"> </div></div>'),re=p('<div><h4 class="text-sm font-semibold mb-2">Evaluation Details</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3"></div></div>'),ae=p('<div class="task-card mb-8 border rounded-lg overflow-hidden"><div><div><h3 class="text-lg font-bold"> </h3> <div class="text-sm text-gray-500 mt-1"> <!> <!></div></div> <div class="flex items-center gap-4"><!> <!></div></div> <div class="p-6"><div class="grid grid-cols-1 lg:grid-cols-2 gap-8"><div class="space-y-6"><!> <!> <!></div> <div class="space-y-6 lg:border-l lg:pl-8"><!> <!></div></div></div></div>'),ie=p('<!> <div class="p-8"><h2 class="text-2xl font-bold mb-6">Tasks</h2> <!></div> <div class="fixed bottom-4 right-4 no-print"><button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded shadow">Print Report</button></div>',1),de=p('<div class="text-center text-gray-500 p-8">No run found</div>'),se=p('<div class="min-h-screen bg-white"><!></div>');function xe(nt,B){jt(B,!1);const h=Y();let i=Y(null),j=Y(!0),y=Y(null),$=Y(null);function k(){const g=window.location.hash.slice(1);if(g){const[o,b]=g.split("/");o&&b&&(L($,b),tt(r($)))}}Ot(()=>(k(),window.addEventListener("hashchange",k),()=>{window.removeEventListener("hashchange",k)}));async function tt(g){L(j,!0),L(y,null);try{L(i,await Jt(g))}catch(o){L(y,o instanceof Error?o.message:"Failed to load run details"),console.error(o)}finally{L(j,!1)}}Tt(()=>r(i),()=>{var g;L(h,(g=r(i))!=null&&g.tasks?{total:r(i).tasks.length,completed:r(i).tasks.filter(o=>o.status==="completed").length,failed:r(i).tasks.filter(o=>o.status==="failed").length,inProgress:r(i).tasks.filter(o=>!["completed","failed"].includes(o.status)).length,avgScore:r(i).tasks.reduce((o,b)=>o+(b.eval_score||0),0)/r(i).tasks.length}:null)}),It(),Dt();var N=se();Lt(g=>{var o=Vt();n(g,o)});var lt=e(N);_(lt,()=>r(j),g=>{Mt(g,{message:"Loading run details..."})},g=>{var o=ut(),b=Z(o);_(b,()=>r(y),O=>{At(O,{get errorMessage(){return r(y)},onRetry:()=>tt(r($))})},O=>{var et=ut(),G=Z(et);_(G,()=>r(i),T=>{var I=ie(),J=Z(I);Ut(J,{get runDetails(){return r(i)},get taskStats(){return r(h)}});var M=a(J,2),ct=a(e(M),2);ft(ct,1,()=>r(i).tasks,bt,(pt,d)=>{var E=ae(),m=e(E),f=e(m),x=e(f),A=e(x);c(()=>l(A,`Task ${r(d).id.slice(-8)??""}`)),t(x);var R=a(x,2),w=e(R);c(()=>l(w,`${new Date(r(d).created_at).toLocaleString()??""} `));var S=a(w);_(S,()=>r(d).finished_at,v=>{var s=wt();c(()=>l(s,`· ${Ft(Bt({start:new Date(r(d).created_at),end:new Date(r(d).finished_at)}),{format:["minutes","seconds"]})??""}`)),n(v,s)});var at=a(S,2);_(at,()=>{var v;return(v=r(d).task_details)==null?void 0:v.model},v=>{var s=wt();c(()=>l(s,`· ${r(d).task_details.model??""}`)),n(v,s)}),t(R),t(f);var it=a(f,2),C=e(it);kt(C,{get status(){return r(d).status},className:"px-3 py-1"});var dt=a(C,2);_(dt,()=>r(d).eval_score!==null,v=>{Ct(v,{get score(){return r(d).eval_score},includePrintStyles:!0,showMinScore:!1})}),t(it),t(m);var st=a(m,2),ot=e(st),K=e(ot),H=e(K);_(H,()=>r(d).task_input,v=>{var s=Wt(),u=a(e(s),2),P=e(u,!0);c(()=>l(P,typeof r(d).task_input=="object"&&"str"in r(d).task_input?r(d).task_input.str:JSON.stringify(r(d).task_input,null,2))),t(u),t(s),n(v,s)});var Q=a(H,2);_(Q,()=>r(d).task_output,v=>{var s=Xt(),u=a(e(s),2),P=e(u,!0);c(()=>l(P,typeof r(d).task_output=="object"&&"str"in r(d).task_output?r(d).task_output.str:JSON.stringify(r(d).task_output,null,2))),t(u),t(s),n(v,s)});var gt=a(Q,2);_(gt,()=>r(d).task_details,v=>{var s=Zt(),u=a(e(s),2);ft(u,5,()=>Object.entries(r(d).task_details),bt,(P,U)=>{let V=()=>r(U)[0],D=()=>r(U)[1];var z=Yt(),W=e(z),_t=e(W,!0);t(W);var F=a(W,2),X=e(F,!0);c(()=>l(X,typeof D()=="string"?V()==="prompt"?zt(D()):D():JSON.stringify(D(),null,2))),t(F),t(z),c(()=>l(_t,V())),n(P,z)}),t(u),t(s),n(v,s)}),t(K);var xt=a(K,2),ht=e(xt);_(ht,()=>{var v;return(v=r(d).eval_details)==null?void 0:v.evaluations},v=>{var s=te(),u=a(e(s),2);Ht(u,{get evaluations(){return r(d).eval_details.evaluations},get evalSpec(){return r(d).eval_spec},includePrintStyles:!0,filter:""}),t(s),n(v,s)});var Et=a(ht,2);_(Et,()=>r(d).eval_details,v=>{var s=re(),u=a(e(s),2);ft(u,5,()=>Object.entries(r(d).eval_details),bt,(P,U)=>{let V=()=>r(U)[0],D=()=>r(U)[1];var z=ut(),W=Z(z);_(W,()=>V()!=="evaluations",_t=>{var F=ee(),X=e(F),Rt=e(X,!0);t(X);var yt=a(X,2),Pt=e(yt,!0);c(()=>l(Pt,typeof D()=="string"?D():JSON.stringify(D(),null,2))),t(yt),t(F),c(()=>l(Rt,V())),n(_t,F)}),n(P,z)}),t(u),t(s),n(v,s)}),t(xt),t(ot),t(st),t(E),c(()=>vt(m,`p-4 flex justify-between items-center
                        ${r(d).status==="completed"?"bg-green-50 border-b-2 border-green-200 print:border-green-300":r(d).status==="failed"?"bg-red-50 border-b-2 border-red-200 print:border-red-300":"bg-gray-50 border-b-2 border-gray-200 print:border-gray-300"}`)),n(pt,E)}),t(M);var q=a(M,2),rt=e(q);t(q),Nt("click",rt,()=>window.print()),n(T,I)},T=>{var I=de();n(T,I)},!0),n(O,et)},!0),n(g,o)}),t(N),n(nt,N),$t()}export{xe as component};
