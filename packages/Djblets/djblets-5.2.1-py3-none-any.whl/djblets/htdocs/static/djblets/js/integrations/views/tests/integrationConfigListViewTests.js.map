{"version":3,"file":"integrationConfigListViewTests.js","names":["suite","template","_","collection","view","beforeEach","$el","$","appendTo","$testsScratch","Djblets","IntegrationConfigListView","configs","el","integrationIDs","integrationsMap","int1","int2","int3","render","list","describe","$row1","$row2","$row3","$row4","$rows","listView","expect","length","toBe","eq","it","$icon1","find","$icon2","$icon3","$icon4","attr","$name1","$name2","$name3","$name4","text","$intName1","$intName2","$intName3","$intName4","trim","hasClass","config","at","spyOn","and","callThrough","fn","callFake","options","buttons","click","modalBox","toHaveBeenCalled","destroy"],"sources":["../../../../../../../static/djblets/js/integrations/views/tests/integrationConfigListViewTests.es6.js"],"sourcesContent":["suite('djblets/integrations/views/IntegrationConfigListView', function() {\n    const template = _.template(dedent`\n        <div class=\"djblets-c-integration-configs\">\n         <div class=\"djblets-l-config-forms-container\">\n          <table class=\"djblets-c-config-forms-list\"></table>\n         </div>\n        </div>\n    `);\n    let collection;\n    let view;\n\n    beforeEach(function() {\n        const $el = $(template()).appendTo($testsScratch);\n\n        view = new Djblets.IntegrationConfigListView({\n            configs: [\n                {\n                    'editURL' : 'configs/1/',\n                    'enabled': true,\n                    'id': 1,\n                    'integrationID': 'int1',\n                    'name': 'Config 1',\n                },\n                {\n                    'editURL' : 'configs/2/',\n                    'enabled': true,\n                    'id': 2,\n                    'integrationID': 'int2',\n                    'name': 'Config 2',\n                },\n                {\n                    'editURL' : 'configs/3/',\n                    'enabled': false,\n                    'id': 3,\n                    'integrationID': 'int3',\n                    'name': 'Config 3',\n                },\n                {\n                    'editURL' : 'configs/4/',\n                    'enabled': true,\n                    'id': 4,\n                    'integrationID': 'int1',\n                    'name': 'Config 4',\n                },\n            ],\n            el: $el,\n            integrationIDs: ['int1', 'int2', 'int3'],\n            integrationsMap: {\n                int1: {\n                    'addURL': 'int1/add/',\n                    'description': 'Int1 Description',\n                    'iconSrc': 'data:test,int1',\n                    'iconSrcSet': 'data:test,int1 1x, data:test,int1@2x 2x',\n                    'id': 'int1',\n                    'name': 'Int1',\n                },\n                int2: {\n                    'addURL': 'int2/add/',\n                    'description': 'Int2 Description',\n                    'iconSrc': 'data:test,int2',\n                    'iconSrcSet': 'data:test,int2 1x, data:test,int2@2x 2x',\n                    'id': 'int2',\n                    'name': 'Int2',\n                },\n                int3: {\n                    'addURL': 'int3/add/',\n                    'description': 'Int3 Description',\n                    'iconSrc': 'data:test,int3',\n                    'iconSrcSet': 'data:test,int3 1x, data:test,int3@2x 2x',\n                    'id': 'int3',\n                    'name': 'Int3',\n                },\n            },\n        });\n        view.render();\n\n        collection = view.list.collection;\n    });\n\n    describe('Configurations', function() {\n        let $row1;\n        let $row2;\n        let $row3;\n        let $row4;\n\n        beforeEach(function() {\n            const $rows = view.listView.$('tr');\n\n            expect($rows.length).toBe(4);\n\n            $row1 = $rows.eq(0);\n            $row2 = $rows.eq(1);\n            $row3 = $rows.eq(2);\n            $row4 = $rows.eq(3);\n        });\n\n        describe('Rendering', function() {\n            it('Icon', function() {\n                const $icon1 =\n                    $row1.find('.djblets-c-integration-config__name img');\n                const $icon2 =\n                    $row2.find('.djblets-c-integration-config__name img');\n                const $icon3 =\n                    $row3.find('.djblets-c-integration-config__name img');\n                const $icon4 =\n                    $row4.find('.djblets-c-integration-config__name img');\n\n                expect($icon1.attr('src')).toBe('data:test,int1');\n                expect($icon2.attr('src')).toBe('data:test,int2');\n                expect($icon3.attr('src')).toBe('data:test,int3');\n                expect($icon4.attr('src')).toBe('data:test,int1');\n\n                expect($icon1.attr('srcset'))\n                    .toBe('data:test,int1 1x, data:test,int1@2x 2x');\n                expect($icon2.attr('srcset'))\n                    .toBe('data:test,int2 1x, data:test,int2@2x 2x');\n                expect($icon3.attr('srcset'))\n                    .toBe('data:test,int3 1x, data:test,int3@2x 2x');\n                expect($icon4.attr('srcset'))\n                    .toBe('data:test,int1 1x, data:test,int1@2x 2x');\n            });\n\n            it('Name', function() {\n                const $name1 =\n                    $row1.find('.djblets-c-integration-config__name a');\n                const $name2 =\n                    $row2.find('.djblets-c-integration-config__name a');\n                const $name3 =\n                    $row3.find('.djblets-c-integration-config__name a');\n                const $name4 =\n                    $row4.find('.djblets-c-integration-config__name a');\n\n                expect($name1.text()).toBe('Config 1');\n                expect($name2.text()).toBe('Config 2');\n                expect($name3.text()).toBe('Config 3');\n                expect($name4.text()).toBe('Config 4');\n\n                expect($name1.attr('href')).toBe('configs/1/');\n                expect($name2.attr('href')).toBe('configs/2/');\n                expect($name3.attr('href')).toBe('configs/3/');\n                expect($name4.attr('href')).toBe('configs/4/');\n            });\n\n            it('Integration name', function() {\n                const $intName1 = $row1.find(\n                    '.djblets-c-integration-config__integration-name');\n                const $intName2 = $row2.find(\n                    '.djblets-c-integration-config__integration-name');\n                const $intName3 = $row3.find(\n                    '.djblets-c-integration-config__integration-name');\n                const $intName4 = $row4.find(\n                    '.djblets-c-integration-config__integration-name');\n\n                expect($intName1.text().trim()).toBe('Int1');\n                expect($intName2.text().trim()).toBe('Int2');\n                expect($intName3.text().trim()).toBe('Int3');\n                expect($intName4.text().trim()).toBe('Int1');\n            });\n\n            it('Status', function() {\n                expect($row1.hasClass('-is-enabled')).toBe(true);\n                expect($row2.hasClass('-is-enabled')).toBe(true);\n                expect($row3.hasClass('-is-enabled')).toBe(false);\n                expect($row4.hasClass('-is-enabled')).toBe(true);\n\n                expect($row1.hasClass('-is-disabled')).toBe(false);\n                expect($row2.hasClass('-is-disabled')).toBe(false);\n                expect($row3.hasClass('-is-disabled')).toBe(true);\n                expect($row4.hasClass('-is-disabled')).toBe(false);\n\n                expect(\n                    $row1.find('.djblets-c-config-forms-list__item-state')\n                    .text()\n                ).toBe('Enabled');\n\n                expect(\n                    $row2.find('.djblets-c-config-forms-list__item-state')\n                    .text()\n                ).toBe('Enabled');\n\n                expect(\n                    $row3.find('.djblets-c-config-forms-list__item-state')\n                    .text()\n                ).toBe('Disabled');\n\n                expect(\n                    $row4.find('.djblets-c-config-forms-list__item-state')\n                    .text()\n                ).toBe('Enabled');\n            });\n        });\n\n        describe('Actions', function() {\n            it('Delete', function() {\n                const config = collection.at(0);\n\n                spyOn(config, 'destroy').and.callThrough();\n                spyOn(config, 'sync');\n\n                spyOn($.fn, 'modalBox').and.callFake(\n                    options => options.buttons[1].click());\n\n                $row1.find('.config-forms-list-action-delete').click();\n\n                expect($.fn.modalBox).toHaveBeenCalled();\n                expect(config.destroy).toHaveBeenCalled();\n\n                expect(collection.length).toBe(3);\n                expect(view.listView.$('tr').length).toBe(3);\n            });\n        });\n    });\n});\n"],"mappings":"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"}