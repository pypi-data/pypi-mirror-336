{"version":3,"file":"conditionSetView.js","names":["BaseConditionRowView","Backbone","View","extend","className","tagName","events","initialize","options","listenTo","model","$el","slideUp","rowAnimationSpeedMS","remove","bind","_onDeleteClicked","e","stopPropagation","preventDefault","destroy","ConditionRowView","template","_","prototype","call","conditionSet","_$choice","_$operator","_$valueWrapper","_$newValue","_defaultValueField","_valueField","render","html","attributes","fieldName","get","rowNum","$","attr","choices","each","choice","append","val","id","text","appendTo","children","_onChoiceChanged","_onOperatorChanged","_onValueChanged","createValueField","empty","operators","operator","newValueField","toggle","setValue","_onSelectChoiceChanged","set","_onSelectOperatorChanged","DisabledConditionRowView","value","Djblets","Forms","ConditionSetView","DEFAULT_ROW_ANIMATION_SPEED_MS","_rowAnimationSpeedMS","_$lastID","_$rows","conditions","bindProperty","_$mode","_$rowsContainer","$rowItems","condition","i","_addConditionRow","_onConditionModeChanged","$rowEl","RowViewCls","rowView","el","undefined","hide","slideDown","_onAddRowClicked","addNewCondition","mode","filter"],"sources":["../../../../../../static/djblets/js/forms/views/conditionSetView.es6.js"],"sourcesContent":["(function() {\n\n\n/**\n * Base view for condition rows.\n *\n * This is responsible for handling common logic for condition row views. It's\n * mainly used to handle deletion of the row.\n */\nconst BaseConditionRowView = Backbone.View.extend({\n    className: 'conditions-field-row',\n    tagName: 'li',\n\n    events: {\n        'click .conditions-field-row-delete': '_onDeleteClicked',\n    },\n\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the view.\n     *\n     * Option Args:\n     *     rowAnimationSpeedMS (number):\n     *         The animation speed for adding/removing rows.\n     */\n    initialize(options) {\n        this.listenTo(this.model, 'destroy', () => {\n            this.$el.slideUp(options.rowAnimationSpeedMS,\n                             this.remove.bind(this));\n        });\n    },\n\n    /**\n     * Callback for when the delete button is clicked.\n     *\n     * Deletes the model, which will in turn delete this row.\n     */\n    _onDeleteClicked(e) {\n        e.stopPropagation();\n        e.preventDefault();\n\n        this.model.destroy();\n    },\n});\n\n\n/**\n * A view representing a row containing a choice, operator, and value.\n *\n * This is responsible for allowing a user to choose the values for one\n * condition. Choosing a choice will populate a list of operators, and choosing\n * an operator will show or hide a value field (depending on the operator).\n */\nconst ConditionRowView = BaseConditionRowView.extend({\n    template: _.template(dedent`\n        <a href=\"#\"\n           class=\"conditions-field-action conditions-field-row-delete\">\n         <span class=\"ink-i-delete-item\"></span>\n        </a>\n        <span class=\"conditions-field-choice\"></span>\n        <span class=\"conditions-field-operator\"></span>\n        <span class=\"conditions-field-value\"></span>\n        <% if (error) { %>\n         <span class=\"conditions-field-error\"><%- error %></span>\n        <% } %>\n    `),\n\n    events: _.extend({\n        'change .conditions-field-choice select': '_onSelectChoiceChanged',\n        'change .conditions-field-operator select': '_onSelectOperatorChanged',\n    }, BaseConditionRowView.prototype.events),\n\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the view.\n     *\n     * Option Args:\n     *     conditionSet (Djblets.Forms.ConditionSet):\n     *         The condition set defining the choices allowed. This is\n     *         required.\n     *\n     *     rowAnimationSpeedMS (number):\n     *         The animation speed for adding/removing rows.\n     */\n    initialize(options) {\n        BaseConditionRowView.prototype.initialize.call(this, options);\n\n        this.conditionSet = options.conditionSet;\n\n        this._$choice = null;\n        this._$operator = null;\n        this._$valueWrapper = null;\n        this._$newValue = null;\n        this._defaultValueField = null;\n        this._valueField = null;\n    },\n\n    /**\n     * Render the view.\n     *\n     * This will create and populate the choice, operator and value fields,\n     * based on the contents of the model, and begin listening to events.\n     *\n     * Returns:\n     *     ConditionRowView:\n     *     The instance, for chaining.\n     */\n    render() {\n        this.$el.html(this.template(this.model.attributes));\n\n        const fieldName = this.conditionSet.get('fieldName');\n        const rowNum = this.model.get('id');\n\n        /* Build the list of choices. This will be populated up-front. */\n        this._$choice = $('<select>')\n            .attr('name', `${fieldName}_choice[${rowNum}]`);\n\n        this.conditionSet.choices.each(choice => {\n            this._$choice.append($('<option>')\n                .val(choice.id)\n                .text(choice.get('name')));\n        });\n\n        this._$choice.appendTo(this.$el.children('.conditions-field-choice'));\n\n        /*\n         * Build the list for the operators. This will be populated when\n         * calling _onChoiceChanged, and whenever the choice changes.\n         */\n        this._$operator = $('<select>')\n            .attr('name', `${fieldName}_operator[${rowNum}]`)\n            .appendTo(this.$el.children('.conditions-field-operator'));\n\n        this._$valueWrapper = this.$el.children('.conditions-field-value');\n\n        /*\n         * Bind all the events so the attributes and inputs reflect each other.\n         * We'll also be binding visibility.\n         */\n        this.listenTo(this.model, 'change:choice', this._onChoiceChanged);\n        this.listenTo(this.model, 'change:operator', this._onOperatorChanged);\n        this.listenTo(this.model, 'change:value', this._onValueChanged);\n\n        /* Set the initial state for the choice and operator from the model. */\n        this._onChoiceChanged();\n        this._onOperatorChanged();\n        this._onValueChanged();\n\n        return this;\n    },\n\n    /**\n     * Callback for when the choice attribute changes on the model.\n     *\n     * Updates the list of operators and sets up a new field for the value,\n     * getting rid of the old one.\n     */\n    _onChoiceChanged() {\n        const choice = this.model.get('choice');\n        const fieldName = this.conditionSet.get('fieldName');\n        const rowNum = this.model.get('id');\n\n        this._$choice.val(choice.id);\n\n        this._defaultValueField = choice.createValueField(\n            `${fieldName}_value[${rowNum}]`);\n\n        /* Rebuild the list of operators for the choice. */\n        this._$operator.empty();\n\n        choice.operators.each(operator => {\n            this._$operator.append(\n                $('<option>')\n                    .val(operator.id)\n                    .text(operator.get('name')));\n        });\n\n        this._$operator.val(this.model.get('operator').id);\n    },\n\n    /**\n     * Callback for when the operator changes on the model.\n     *\n     * Updates the visibility of the value, based on whether the operator\n     * needs one.\n     */\n    _onOperatorChanged() {\n        const operator = this.model.get('operator');\n        let newValueField;\n\n        this._$operator.val(operator.id);\n        this._$valueWrapper.toggle(operator.get('useValue'));\n\n        if (operator.get('valueField') !== null) {\n            const fieldName = this.conditionSet.get('fieldName');\n            const rowNum = this.model.get('id');\n\n            newValueField = operator.createValueField(\n                `${fieldName}_value[${rowNum}]`);\n        } else {\n            newValueField = this._defaultValueField;\n        }\n\n        if (newValueField !== this._valueField) {\n            /* Replace the old value field with a new one for this choice. */\n            if (this._$newValue !== null &&\n                newValueField !== this._valueField) {\n                this._$newValue.remove();\n                this._$newValue = null;\n            }\n\n            this._valueField = newValueField;\n\n            this._$newValue = this._valueField.render().$el\n                .appendTo(this._$valueWrapper);\n        }\n    },\n\n    /**\n     * Callback for when the value changes on the model.\n     *\n     * Updates the field to reflect the new value.\n     */\n    _onValueChanged() {\n        this._valueField.setValue(this.model.get('value'));\n    },\n\n    /**\n     * Callback for when a new condition choice is chosen in the drop-down.\n     *\n     * Updates the choice in the model.\n     */\n    _onSelectChoiceChanged() {\n        this.model.set('choice',\n                       this.conditionSet.choices.get(this._$choice.val()));\n    },\n\n    /**\n     * Callback for when a new operator is chosen in the drop-down.\n     *\n     * Updates the operator in the model.\n     */\n    _onSelectOperatorChanged() {\n        const choice = this.model.get('choice');\n\n        this.model.set('operator',\n                       choice.operators.get(this._$operator.val()));\n    },\n});\n\n\n/**\n * A view representing a disabled condition row.\n *\n * This is used for conditions that are considered invalid (ones whose choice\n * or operator could not be found when loading). The condition is shown in a\n * disabled state, with the raw value alongside it (if set). It can only be\n * removed.\n */\nconst DisabledConditionRowView = BaseConditionRowView.extend({\n    render() {\n        const value = this.model.get('value');\n\n        if (value !== null) {\n            this.$('.conditions-field-value').text(value);\n        }\n\n        return this;\n    },\n});\n\n\n/**\n * A view for creating, editing, and deleting a set of conditions.\n *\n * This starts off by listing all the conditions already configured (as\n * represented by the data in the associated model), and allows those\n * conditions to be edited/deleted or new ones to be created.\n *\n * Options:\n *     rowAnimationSpeedMS (number):\n *         The animation speed (in milliseconds) for adding or removing\n *         condition rows.\n */\nDjblets.Forms.ConditionSetView = Backbone.View.extend({\n    DEFAULT_ROW_ANIMATION_SPEED_MS: 300,\n\n    events: {\n        'change #conditions_mode input': '_onConditionModeChanged',\n        'click .conditions-field-add-condition a': '_onAddRowClicked',\n    },\n\n    /**\n     * Initialize the view.\n     */\n    initialize(options) {\n        this._rowAnimationSpeedMS = options.rowAnimationSpeedMS ||\n                                    this.DEFAULT_ROW_ANIMATION_SPEED_MS;\n\n        this._$lastID = null;\n        this._$rows = null;\n    },\n\n    /**\n     * Render the view.\n     *\n     * This will construct a :js:class:`ConditionRowView` for each condition\n     * that has been provided, and hook up events to handle the creation or\n     * deletion of conditions.\n     *\n     * Returns:\n     *     Djblets.Forms.ConditionSetView:\n     *     This instance, for chaining.\n     */\n    render() {\n        const fieldName = this.model.get('fieldName');\n        const conditions = this.model.conditions;\n\n        this._$lastID = this.$el.children(`input[name=${fieldName}_last_id]`)\n            .bindProperty('value', this.model, 'lastID');\n        this._$mode = this.$('#conditions_mode input');\n        this._$rowsContainer = this.$('.conditions-field-rows-container');\n        this._$rows = this._$rowsContainer.children('.conditions-field-rows');\n\n        /* Render rows for any existing conditions. */\n        const $rowItems = this._$rows.children();\n\n        conditions.each((condition, i) => {\n            this._addConditionRow(condition, $rowItems[i]);\n        });\n\n        /* Begin listening for any events that impact the rows or inputs. */\n        this.listenTo(conditions, 'add',\n                      condition => this._addConditionRow(condition));\n\n        this._onConditionModeChanged();\n\n        return this;\n    },\n\n    /**\n     * Add a condition row to the UI.\n     *\n     * This is called when a new condition has been added in the models. It\n     * constructs a :js:class:`ConditionRowView` and renders it in the list.\n     *\n     * Args:\n     *     condition (Djblets.Forms.Condition):\n     *         The condition being added.\n     *\n     *     $rowEl (jQuery):\n     *         The element to use for the row. If not provided, a new one\n     *         will be created.\n     */\n    _addConditionRow(condition, $rowEl) {\n        const RowViewCls = condition.get('valid')\n                           ? ConditionRowView\n                           : DisabledConditionRowView;\n\n        const rowView = new RowViewCls({\n            conditionSet: this.model,\n            el: $rowEl,\n            model: condition,\n            rowAnimationSpeedMS: this._rowAnimationSpeedMS,\n        });\n        rowView.render();\n\n        if ($rowEl === undefined) {\n            rowView.$el\n                .hide()\n                .appendTo(this._$rows)\n                .slideDown(this._rowAnimationSpeedMS);\n        }\n    },\n\n    /**\n     * Handler for when \"Add a new condition\" is clicked.\n     *\n     * This adds a new condition to the model, which will in turn render the\n     * new row to the list.\n     *\n     * Args:\n     *     e (Event):\n     *         The click event.\n     */\n    _onAddRowClicked(e) {\n        e.stopPropagation();\n        e.preventDefault();\n\n        this.model.addNewCondition();\n    },\n\n    /**\n     * Handler for when the condition mode changes.\n     *\n     * If the current mode is \"Always\", hide the conditions list.\n     */\n    _onConditionModeChanged() {\n        const mode = this._$mode.filter(':checked').val();\n\n        this._$rowsContainer.toggle(mode !== 'always');\n    },\n});\n\n\n})();\n"],"mappings":"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"}