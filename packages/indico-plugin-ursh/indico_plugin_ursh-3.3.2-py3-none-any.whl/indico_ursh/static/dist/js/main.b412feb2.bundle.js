(()=>{"use strict";const t=_IndicoUtilsAxios,o=$T.domain("ursh");function e(t,o,e="unfocus"){t.qtip({content:{text:o},hide:{event:e,fixed:!0,delay:700},show:{event:!1,ready:!0}})}async function n(o){let e;try{e=await t.indicoAxios.post("/ursh",{original_url:o})}catch(o){return void(0,t.handleAxiosError)(o)}return e.data.url}function s(t){const n=t.val().trim();t.val(n);try{const e=function(t){if(!t)throw Error(o.gettext("Please fill in a URL to shorten"));t.startsWith(location.hostname)&&(t=`${location.protocol}//${t}`);const e=RegExp("^([\\d\\w]+:)//([^/ .]+(?:\\.[^/ .]+)*)(/.*)?$"),n=t.match(e);if(!n)throw Error(o.gettext("This does not look like a valid URL"));const s=n[2],r=n[3]?n[3]:"/",i=location.protocol;if(s!==location.hostname)throw Error(o.gettext("Invalid host: only Indico URLs are allowed"));return`${i}//${s}${r}`}(n);return t.val(e),e}catch(o){return e(t,o.message),t.focus().select(),null}}async function r(t){t.preventDefault();const r=$("#ursh-shorten-input"),i=s(r);if(i){const t=await n(i);if(t){const o=$("#ursh-shorten-output");$("#ursh-shorten-response-form").slideDown(),o.val(t),o.select()}else e(r,o.gettext("This does not look like a valid URL")),r.focus().select()}}$(document).on("click","#ursh-shorten-button",r).on("keydown","#ursh-shorten-input",(t=>{"Enter"===t.key&&r(t)})).on("click",".ursh-get",(async function(t){t.preventDefault();const o=t.target.dataset.originalUrl,e=await n(o);$(t.target).copyURLTooltip(e,"unfocus")})).on("input","#ursh-custom-shortcut-input",(t=>{const o=$(t.target).val();$("#ursh-custom-shortcut-submit-button").prop("disabled",!(o.length>=5))})).on("mouseenter","#ursh-custom-shortcut-submit-button",(t=>{t.target.disabled&&e($(t.target),o.gettext("Please check that the shortcut is correct"),"mouseleave")})),$(document).ready((()=>{$(".ursh-dropdown").next("ul").find("li a").on("menu_select",(()=>!0))}))})();
//# sourceMappingURL=main.b412feb2.bundle.js.map