{"version":3,"sources":["components/terminal/Terminal.js"],"names":["Terminal","xtermRef","useRef","fitAddon","FitAddon","socket","io","process","REACT_APP_SOCKET_URL","withCredentials","useEffect","on","console","debug","id","connected","fit","dims","cols","current","terminal","rows","focus","emit","disconnect","data","write","output","options","cursorBlink","macOptionIsMeta","scrollback","theme","background","foreground","className","ref","onData","input","addons","memo"],"mappings":"wHAAA,sGAqBaA,EAAW,WACtB,IAAMC,EAAWC,mBACXC,EAAW,IAAIC,WACfC,EAASC,YAAGC,wJAAYC,qBAAsB,CAElDC,iBAAiB,IAmCnB,OAjCAC,qBAAU,WACJL,GACFA,EAAOM,GAAG,WAAW,WAAO,IAAD,IACzBC,QAAQC,MAAR,iBACYR,EAAOS,GADnB,gCAC6CT,EAAOU,YAEpDZ,EAASa,MACT,IAIe,EAJTC,EAAO,CACXC,KAAI,OAAEjB,QAAF,IAAEA,GAAF,UAAEA,EAAUkB,eAAZ,aAAE,EAAmBC,SAASF,KAClCG,KAAI,OAAEpB,QAAF,IAAEA,GAAF,UAAEA,EAAUkB,eAAZ,aAAE,EAAmBC,SAASC,MAEhCJ,EAAKI,OACC,OAARpB,QAAQ,IAARA,GAAA,UAAAA,EAAUkB,eAAV,SAAmBC,SAASE,QAC5BjB,EAAOkB,KAAK,iBAAkBN,GAC9BZ,EAAOkB,KAAK,SAAUN,UAK9BP,qBAAU,WACR,GAAIL,EACF,OAAO,WACLA,EAAOmB,iBAIbd,qBAAU,WACJL,GACFA,EAAOM,GAAG,cAAc,SAAUc,GAAO,IAAD,EAC9B,OAARxB,QAAQ,IAARA,GAAA,UAAAA,EAAUkB,eAAV,SAAmBC,SAASM,MAAMD,EAAKE,cAK3C,mCACGtB,GACC,cAAC,IAAD,CACE,cAAY,WACZuB,QAAS,CACPC,aAAa,EACbC,iBAAiB,EACjBC,WAAY,IACZC,MAAO,CACLC,WAAY,UACZC,WAAY,YAGhBC,UAAU,OACVC,IAAKnC,EACLoC,OAAQ,SAACZ,GACPpB,EAAOkB,KAAK,YAAa,CAAEe,MAAOb,KAEpCc,OAAQ,CAACpC,QAMJqC,yBAAKxC","file":"static/js/3.0dbd9381.chunk.js","sourcesContent":["/**\n * This file is part of Covalent.\n *\n * Licensed under the Apache License 2.0 (the \"License\"). A copy of the\n * License may be obtained with this software package or at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Use of this file is prohibited except in compliance with the License.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useRef, useEffect, memo } from 'react'\nimport { XTerm } from 'xterm-for-react'\nimport { FitAddon } from 'xterm-addon-fit'\nimport io from 'socket.io-client'\nimport './index.css'\nexport const Terminal = () => {\n  const xtermRef = useRef()\n  const fitAddon = new FitAddon()\n  const socket = io(process.env.REACT_APP_SOCKET_URL, {\n    // required for CORS\n    withCredentials: true,\n  })\n  useEffect(() => {\n    if (socket) {\n      socket.on('connect', () => {\n        console.debug(\n          `socket ${socket.id} terminal connected: ${socket.connected}`\n        )\n        fitAddon.fit()\n        const dims = {\n          cols: xtermRef?.current?.terminal.cols,\n          rows: xtermRef?.current?.terminal.rows,\n        }\n        if (dims.rows) {\n          xtermRef?.current?.terminal.focus()\n          socket.emit('start_terminal', dims)\n          socket.emit('resize', dims)\n        }\n      })\n    }\n  })\n  useEffect(() => {\n    if (socket) {\n      return () => {\n        socket.disconnect()\n      }\n    }\n  })\n  useEffect(() => {\n    if (socket) {\n      socket.on('pty-output', function (data) {\n        xtermRef?.current?.terminal.write(data.output)\n      })\n    }\n  })\n  return (\n    <>\n      {socket && (\n        <XTerm\n          data-testid=\"terminal\"\n          options={{\n            cursorBlink: true,\n            macOptionIsMeta: true,\n            scrollback: 500,\n            theme: {\n              background: '#08081A',\n              foreground: '#AEB6FF',\n            },\n          }}\n          className=\"term\"\n          ref={xtermRef}\n          onData={(data) => {\n            socket.emit('pty-input', { input: data })\n          }}\n          addons={[fitAddon]}\n        />\n      )}\n    </>\n  )\n}\nexport default memo(Terminal)\n"],"sourceRoot":""}